/*

 @fileoverview GlobalView - Fast client-side scatter plot rendering using WebGL
 @author Sebastian Klaassen
 @version 0.1.0

    <<< GlobalView Scatter Plot Framework >>>

 MIT License

 Copyright (c) 2017 Sebastian Klaassen

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.


 Third-Party License Information:
    This framework uses the following additional libraries:
    Software		Version	License			File											Homepage
    gl-matrix		2.3.2	MIT License		./lib/gl-matrix.min.js							http://glmatrix.net/
    Parallel.js		0.2.1	BSD License		./lib/parallel.js								https://parallel.js.org/
    jquery-csv		0.8.3	MIT License		./lib/jquery-csv.min.js							https://github.com/evanplaice/jquery-csv
    webgl-utils.js		-	BSD License		partially minified into this file (see below)	https://www.khronos.org/registry/webgl/sdk/demos/common/webgl-utils.js
    Full copyright disclaimers can be found either below or in the individual library files
*/
var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,e){b!=Array.prototype&&b!=Object.prototype&&(b[d]=e.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(b,d){if(d){var e=ba;b=b.split(".");for(var c=0;c<b.length-1;c++){var h=b[c];h in e||(e[h]={});e=e[h]}b=b[b.length-1];c=e[b];d=d(c);d!=c&&null!=d&&aa(e,b,{configurable:!0,writable:!0,value:d})}}
da("Array.prototype.fill",function(b){return b?b:function(b,e,c){var d=this.length||0;0>e&&(e=Math.max(0,d+e));if(null==c||c>d)c=d;c=Number(c);0>c&&(c=Math.max(0,d+c));for(e=Number(e||0);e<c;e++)this[e]=b;return this}});function ea(){ea=function(){};ba.Symbol||(ba.Symbol=ga)}var ja=0;function ga(b){return"jscomp_symbol_"+(b||"")+ja++}
function ka(){ea();var b=ba.Symbol.iterator;b||(b=ba.Symbol.iterator=ba.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return la(this)}});ka=function(){}}function la(b){var d=0;return ma(function(){return d<b.length?{done:!1,value:b[d++]}:{done:!0}})}function ma(b){ka();b={next:b};b[ba.Symbol.iterator]=function(){return this};return b}
function na(b,d){ka();b instanceof String&&(b+="");var e=0,c={next:function(){if(e<b.length){var h=e++;return{value:d(h,b[h]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c}
da("Array.from",function(b){return b?b:function(b,e,c){ka();e=e?e:function(b){return b};var d=[],k=b[Symbol.iterator];if("function"==typeof k)for(b=k.call(b);!(k=b.next()).done;)d.push(e.call(c,k.value));else for(var k=b.length,p=0;p<k;p++)d.push(e.call(c,b[p]));return d}});da("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991});
da("String.prototype.endsWith",function(b){return b?b:function(b,e){if(null==this)throw new TypeError("The 'this' value for String.prototype.endsWith must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype.endsWith must not be a regular expression");var c=this+"";b+="";void 0===e&&(e=c.length);e=Math.max(0,Math.min(e|0,c.length));for(var d=b.length;0<d&&0<e;)if(c[--e]!=b[--d])return!1;return 0>=d}});
da("Array.prototype.values",function(b){return b?b:function(){return na(this,function(b,e){return e})}});var oa=this;function qa(b,d){b=b.split(".");var e=oa;b[0]in e||!e.execScript||e.execScript("var "+b[0]);for(var c;b.length&&(c=b.shift());)b.length||void 0===d?e[c]&&e[c]!==Object.prototype[c]?e=e[c]:e=e[c]={}:e[c]=d};function J(b){return"undefined"===typeof b}function K(b){return"function"===typeof b}function L(b){return"[object Array]"===Object.prototype.toString.call(b)}function N(b){return"string"===typeof b}function ra(b){return"number"===typeof b}function sa(b){return!(K(b)||b instanceof WebGLTexture)}Array.create=function(b,d){var e=Array(b);if(K(d))for(var c=0;c<b;++c)e[c]=d(c);else e.fill(d);return e};function ta(b){return b.reduce(function(b,e,c,h){return e<h[b]?c:b},0)}
String.prototype.format||(String.prototype.format=function(b){var d=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof d[c]?d[c]:b})});String.prototype.a=function(b,d,e){var c=arguments;return this.replace(b,function(b,e){e=Number.parseInt(e,10)+2;return"undefined"!=typeof c[e]?c[e]:d})};
function ua(b){var d=typeof b;if("undefined"===d||"function"===d||"string"===d||"number"===d||"[object Array]"===Object.prototype.toString.call(b))return b;for(var e in b)if(!sa(b[e])){d={};for(e in b)sa(b[e])&&(d[e]=b[e]);return d}return b}
function va(b){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",
gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",
lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",
orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",
slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}[b.toLowerCase()]}
function Ba(b){b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(b,e,c,h){return e+e+c+c+h+h});return(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?{r:parseInt(b[1],16),Fa:parseInt(b[2],16),la:parseInt(b[3],16)}:null}function Ca(b){b=b.match(/\d+/g);for(var d=0;4>d;++d)b[d]=d<b.length?Math.max(0,Math.min(255,b[d]/255)):1;return b}
function Da(b){if(1E-6>=b[1])return[b[2],b[2],b[2]];var d=b[0];1<=d&&(d=0);d*=6;var e=Math.floor(d);var c=d-e;d=b[2]*(1-b[1]);var h=b[2]*(1-b[1]*c);c=b[2]*(1-b[1]*(1-c));switch(e){case 0:return[b[2],c,d];case 1:return[h,b[2],d];case 2:return[d,b[2],c];case 3:return[d,h,b[2]];case 4:return[c,d,b[2]];default:return[b[2],d,h]}}var Ea,Fa=1;Math.xb=function(){var b=1E4*Math.sin(Fa++);return b-Math.floor(b)};Math.sb=function(b,d,e){return Math.min(Math.max(b,d),e)};
function Ga(b){var d=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.attachEvent?document.attachEvent("on"+d,b):document.addEventListener&&document.addEventListener(d,b,!1)}function La(b){document.attachEvent?document.attachEvent("onmousemove",b):document.addEventListener&&document.addEventListener("mousemove",b,!1)}function Ma(b){document.attachEvent?document.attachEvent("onmouseup",b):document.addEventListener&&document.addEventListener("mouseup",b,!1)}
function Na(b){document.attachEvent?document.attachEvent("onkeydown",b):document.addEventListener&&document.addEventListener("keydown",b,!1)}function Oa(b){document.attachEvent?document.attachEvent("onkeyup",b):document.addEventListener&&document.addEventListener("keyup",b,!1)}
function Pa(b){this.value=b;this.next=null;this.push=function(b){var e=new Pa(this.value);e.next=this.next;this.next=e;this.value=b};this.size=function(){for(var b=0,e=this;e;e=e.next)++b;return b};this.forEach=function(b){for(var e=this;e;e=e.next)b(e.value)};Qa=function(b,e){for(var c,d=new Pa(null),k=d;null!==b&&null!=e;)b.value<=e.value?(c=b,b=c.next):(c=e,e=c.next),c.next=k.next,k.next=c,k=k.next;k.next=null===b?e:b;return d.next}}var Qa;
function Ra(b){var d=[];this.length=0;this.push=function(e){++this.length;var c,h=e[b];for(c=0;c<d.length&&d[c][b]>=h;c++);d.splice(c,0,e)};this.pop=function(){--this.length;return d.pop()}}
function Sa(b){var d={};this.length=0;this.a=K(b)?b:function(){};this.push=this.push=function(b){!0!==d[b]&&(d[b]=!0,++this.length,this.a())};this.append=function(b){var c=!1,e=this;b.forEach(function(b){!0!==d[b]&&(d[b]=!0,++e.length,c=!0)});c&&this.a()};this.set=this.set=function(b){if(1!==this.length||!0!==d[b])d={},d[b]=!0,this.length=1,this.a()};this.assign=this.assign=function(b){if(0===b.length)this.clear();else{var c={},e=b.length===this.length;b.forEach(function(b){e&&!0!==d[b]&&(e=!1);c[b]=
!0});d=c;this.length=b.length;!1===e&&this.a()}};this.assignRange=this.c=function(b){0>=b||(d=Array(b),d.fill(!0),this.length=b,this.a())};this.erase=function(b){!0===d[b]&&(delete d[b],--this.length,this.a())};this.remove=function(b){var c=!1,e=this;b.forEach(function(b){!0===d[b]&&(delete d[b],--e.length,c=!0)});c&&this.a()};this.isempty=function(){return 0===this.length};this.clear=this.clear=function(){0!==this.length&&(d={},this.length=0,this.a())};this.forEach=this.forEach=function(b){for(var c in d)c=
Number.parseInt(c,10),b(c)};this.get=this.get=function(){return new Uint32Array(Object.keys(d).map(Number))};this.size=this.size=function(){return this.length};this.contains=function(b){return!0===d[b]}}qa("HashSet",Sa);function Ta(b,d){function e(b){p=b;return null}function c(){return l=b.charAt(++m)}function h(){do{var b=!1;switch(l){case "":return f=null,!0;case "+":switch(c()){case "+":return c(),f="++",!0;case "=":return c(),f="+=",!0;default:return f="+",!0}case "-":switch(c()){case "-":return c(),f="--",!0;case "=":return c(),f="-=",!0;default:if(!("0"<=l&&"9">=l))return f="-",!0}case "*":switch(c()){case "=":return c(),f="*=",!0;default:return f="*",!0}case "/":switch(c()){case "=":return c(),f="/=",!0;default:return f=
"/",!0}case "(":case ")":case ",":case "=":case ";":case ".":return f=l,c(),!0;case " ":case "\t":case "\r":case "\n":c(),b=!0}}while(b);if("0"<=l&&"9">=l){b=l;for(var d=!1;""!==c();)if("0"<=l&&"9">=l)b+=l;else if("."!==l)break;else{if(d)return e("Unexpected character: "+l);d=!0;b+=l}d?(f="float",g=1*Number.parseFloat(b)):(f="int",g=1*Number.parseInt(b,10));return!0}if("a"<=l&&"z">=l||"A"<=l&&"Z">=l){for(b=l;""!==c();)if("a"<=l&&"z">=l||"A"<=l&&"Z">=l||"0"<=l&&"9">=l||"_"===l)b+=l;else break;f="identifier";
g=b;return!0}return e("Unexpected character: "+l)}function k(b){switch(b){case "=":return 10;case "+=":return 10;case "-=":return 10;case "*=":return 10;case "/=":return 10;case "?":return 20;case "||":return 30;case "&&":return 40;case "==":return 50;case "<":return 60;case ">":return 60;case "+":return 70;case "-":return 70;case "*":return 80;case "/":return 80;case "%":return 80;default:return-1}}var p=null;O.vec3.wb={x:O.float,y:O.float,z:O.float};var n={"float = float":O.float,"float += float":O.float,
"float -= float":O.float,"float *= float":O.float,"float /= float":O.float,"float + float":O.float,"float - float":O.float,"float * float":O.float,"float / float":O.float,"vec3(float, float, float)":O.vec3,"vec3 = vec3":O.vec3,"vec3 + vec3":O.vec3,"vec3 * float":O.vec3,"sin(float)":O.float,"cos(float)":O.float,"tan(float)":O.float,"asin(float)":O.float,"acos(float)":O.float,"atan(float)":O.float,"min(float, float)":O.float,"max(float, float)":O.float},m=0,l=b.charAt(0),f=null,g;return function(){function b(g,
c){for(;;){var l=k(f);if(l<g)return c;var d=f;if(!h())return null;if("?"!=d){var q=x(l);if(null==q||l<k(f)&&(q=b(l+1,q),null==q))return null;var m=c.type.name+" "+d+" "+q.type.name,t=n[m];if(J(t))return e("Undefined operator "+d+" on FormulaCompiler.types "+c.type.name+" and "+q.type.name);if(10===l){l=c.code.pop();if("@"!==l&&"@[]"!==l)return e("Cannot assign to non-variable");c.type=t;c.code=q.code.concat(c.code)}else c.type=t,c.code=c.code.concat(q.code);c.code.push(m)}}}function c(){var b=g,c=
[b];if(!h())return null;for(var d=r[b];"."===f;){if(!h())return null;if(J(d))return e("Undefined variable: "+b);var q=d,k=d.nb[g];if(J(k))return e(q.name+" does not contain a member: "+g);d=k.type;c.push(".");c.push(k.index);if(!h())return null}if("("===f)return 1!==c.length?e("Member functions not suported"):m(b);if("identifier"===f)return 1!==c.length?e("Hierarchical FormulaCompiler.types not suported"):l(c,b);if(J(d))return e("Undefined variable: "+b);c.push(d===O.float?"@":"@[]");return{code:c,
type:d}}function l(b,f){b=O[f];if(J(b))return e("Unsupported type: "+f);if(!J(r[g]))return e("Redefinition of variable: "+g);r[g]=b;f=[g];if(!h())return null;f.push(b===O.float?"@":"@[]");return{code:f,type:b}}function m(b){if(!h())return null;var g=A();if(!g)return null;var f=g.type.map(function(b){return b.name}).join(", ");b=b+"("+f+")";f=n[b];if(J(f))return e("Undefined function "+b);g=g.code;g.push(b);return{code:g,type:f}}function A(){if(")"===f)return h()?[0]:null;for(var b=[],g=[],c=1;;){var l=
x();if(!l)return null;b=b.concat(l.code);g.push(l.type);if(")"===f)break;else if(","!==f)return e("Expected ',' or ')' after list element");if(!h())return null;++c}return h()?{code:b,type:g}:null}function v(){switch(f){case "identifier":var b=c();return b?b:null;case "float":case "int":return b=g,h()?{code:[b],type:O.float}:null;default:return e("unknown token '{0}' when expecting an expression".format(f))}}function x(g){J(g)&&(g=0);var f=v();return f?b(g,f):null}var r=d?d:{},w=function(){var g=[];
if(!h())return null;for(;null!==f;){var c=v();if(!c)return null;c=b(0,c);if(!c)return null;if(";"!==f)return e("Missing ';' after expression");if(!h())return null;g=g.concat(c.code);g.push(";")}g.length&&g.pop();return g}();return w?w:p}()}var O={float:{name:"float"},vec3:{name:"vec3"}};O.vec3.nb={x:{index:0,type:O.float},y:{index:1,type:O.float},z:{index:2,type:O.float}};function Ua(b){var d=new Ra("cost"),e={},c={state:b.ib(),ab:0};if(!b.Va(c.state))for(e[b.Sa(c.state)]=c.state;;){b.hb(c.state,function(c,k){var h=b.Sa(c);J(e[h])&&(d.push({state:c,ab:k}),e[h]=c)});if(!d.length)break;c=d.pop();if(b.Va(c.state)){d=null;break}}};function Va(b){b.W=function(d){return b.transform[0]*d+b.transform[1]};b.X=function(d){return b.transform[2]*d+b.transform[3]};b.ba=function(d){return(d-b.transform[1])/b.transform[0]};b.ma=function(d){return(d-b.transform[3])/b.transform[2]}}
function Wa(b){this.data=b.data;this.width=b.width;this.height=b.height;this.g=b.g;this.h=b.h;this.scale=b.scale;this.offset=b.offset;this.transform=b.transform;this.options=b.options;this.W=function(b){return this.transform[0]*b+this.transform[1]};this.X=function(b){return this.transform[2]*b+this.transform[3]};this.ba=function(b){return(b-this.transform[1])/this.transform[0]};this.ma=function(b){return(b-this.transform[3])/this.transform[2]}}
function Xa(b){b?(this.maxExpectedRuntime=b.maxExpectedRuntime,this.cutoffIntensity=b.cutoffIntensity,this.gaussScale=b.gaussScale,this.logScale=b.logScale,this.inflateToFit=b.inflateToFit,this.shrinkToFit=b.shrinkToFit):(this.maxExpectedRuntime=1,this.cutoffIntensity=.001,this.gaussScale=1E3,this.shrinkToFit=this.inflateToFit=this.logScale=!0)}qa("DensityMapOptions",Xa);
function Ya(b,d){return b.maxExpectedRuntime===d.maxExpectedRuntime&&b.cutoffIntensity===d.cutoffIntensity&&b.gaussScale===d.gaussScale&&b.logScale===d.logScale&&b.inflateToFit===d.inflateToFit&&b.shrinkToFit===d.shrinkToFit}
function Za(b){this.data=b.data;this.Ca=b.Ca;this.ua=b.ua;this.threshold=b.threshold;this.n=b.n;this.width=b.width;this.height=b.height;this.transform=b.transform;this.W=function(b){return this.transform[0]*b+this.transform[1]};this.X=function(b){return this.transform[2]*b+this.transform[3]};this.ba=function(b){return(b-this.transform[1])/this.transform[0]};this.ma=function(b){return(b-this.transform[3])/this.transform[2]}}
function $a(b){b?(this.ta=b.ta,this.threshold=this.threshold=b.threshold):(this.ta=null,this.threshold=this.threshold=.1)}qa("ClusterMapOptions",$a);function ab(b,d){return Ya(b.ta.options,d.ta.options)&&b.threshold===d.threshold}function bb(b,d,e){var c=b.length;b=b.f[d];d=e/(b.h-b.g);for(var h=-b.g*d,k=[d,h,1,0],p=new Float32Array(e),n=1,m=0;m<c;++m){var l=Math.floor(b.m(m)*d+h);++p[Math.min(e-1,l)]>n&&++n}return p={data:p,h:n,width:e,height:1,transform:k}}
function cb(b,d,e,c,h){var k=b.length;d=b.f[d];b=b.f[e];e=c/(d.h-d.g);for(var p=-d.g*e,n=h/(b.h-b.g),m=-b.g*n,l=[e,p,n,m],f=new Float32Array(c*h),g=1,q=0;q<k;++q){var t=Math.floor(d.m(q)*e+p),u=Math.floor(b.m(q)*n+m);++f[Math.min(h-1,u)*c+Math.min(c-1,t)]>g&&++g}return f={data:f,h:g,width:c,height:h,transform:l}}
function db(b,d){var e=b.width,c=b.height,h=b.transform.slice(),k=b.data;var p=b.h;var n=d.cutoffIntensity,m=d.gaussScale,l=-m/(e*c),f=d.logScale,g=d.inflateToFit,q=Math.max(e,c),t=0,u=Number.MAX_VALUE,D=Number.MIN_VALUE,A=Number.MAX_VALUE;var v=Number.MIN_VALUE;var x=performance.now();if(g)for(b=0;b<c;++b)for(var r=0;r<e;++r){if(0!==k[b*e+r]){var w=Math.floor(Math.sqrt(Math.log(n/k[b*e+r])/l))-1;w=Math.max(1,Math.min(q,w));t+=w*w*Math.PI;u=Math.min(u,r-w);D=Math.max(D,r+w);A=Math.min(A,b-w);v=Math.max(v,
b+w)}}else for(b=0;b<c;++b)for(r=0;r<e;++r)if(0!==k[b*e+r]){w=Math.floor(Math.sqrt(Math.log(n/k[b*e+r])/l))-1;w=Math.max(1,Math.min(q,w));var B=Math.min(w,Math.min(r,e-r))/w;var G=Math.min(w,Math.min(b,c-b))/w;B=.5+.5*B*B;G=.5+.5*G*G;t+=w*w*Math.PI*B*G}t=g?.011447356659209*Math.pow(t,.508796587646921):.017471566555264*Math.pow(t,.466050299746328);for(t*=(performance.now()-x)/1E3;t>d.maxExpectedRuntime&&2<=e&&2<=c;){u=e>>1;A=c>>1;h[0]*=u/e;h[1]*=u/e;h[2]*=A/c;h[3]*=A/c;c=new Float32Array(u*A);p=1;
for(b=0;b<A;++b)for(r=0;r<u;++r)p=Math.max(p,c[b*u+r]=k[(2*b+0)*e+(2*r+0)]+k[(2*b+0)*e+(2*r+1)]+k[(2*b+1)*e+(2*r+0)]+k[(2*b+1)*e+(2*r+1)]);k=c;e=u;c=A;q=Math.max(e,c);l=-m/(e*c);t=0;u=Number.MAX_VALUE;D=Number.MIN_VALUE;A=Number.MAX_VALUE;v=Number.MIN_VALUE;x=performance.now();if(g)for(b=0;b<c;++b)for(r=0;r<e;++r)k[b*e+r]&&(w=Math.floor(Math.sqrt(Math.log(n/k[b*e+r])/l))-1,w=Math.max(1,Math.min(q,w)),t+=w*w*Math.PI,u=Math.min(u,r-w),D=Math.max(D,r+w),A=Math.min(A,b-w),v=Math.max(v,b+w));else for(b=
0;b<c;++b)for(r=0;r<e;++r)k[b*e+r]&&(w=Math.floor(Math.sqrt(Math.log(n/k[b*e+r])/l))-1,w=Math.max(1,Math.min(q,w)),B=Math.min(w,Math.min(r,e-r))/w,G=Math.min(w,Math.min(b,c-b))/w,B=.5+.5*B*B,G=.5+.5*G*G,t+=w*w*Math.PI*B*G);b=(performance.now()-x)/1E3;t=g?.011447356659209*Math.pow(t,.508796587646921):.017471566555264*Math.pow(t,.466050299746328);t*=b}g?(d.shrinkToFit&&(--u,++D,--A,++v),m=D-u+1,G=v-A+1,h[1]-=u,h[3]-=A):(m=e,G=c);t=new Float32Array(m*G);q=Math.min(Math.floor(Math.sqrt(Math.log(n/p)/
l)),q);D=new Float32Array(q*q);for(b=0;b<q;++b)for(r=0;r<q;++r)D[b*q+r]=Math.exp(l*(r*r+b*b));if(g)for(b=0;b<c;++b)for(r=0;r<e;++r){if(0!==k[b*e+r])if(v=k[b*e+r],w=Math.sqrt(Math.log(n/v)/l),w=Math.min(Math.floor(w),q)-1,0>=w)t[b*m+r]+=v;else for(p=w*w,B=b-w,w=b+w;B<=w;++B){var H=Math.floor(Math.sqrt(p-(B-b)*(B-b)));x=r-H;for(H=r+H;x<=H;++x)t[(B-A)*m+x-u]+=v*D[Math.abs(b-B)*q+Math.abs(r-x)]}}else for(b=0;b<c;++b)for(r=0;r<e;++r)if(0!==k[b*e+r])if(v=k[b*e+r],w=Math.sqrt(Math.log(n/v)/l),w=Math.min(Math.floor(w),
q)-1,0>=w)t[b*m+r]+=v;else for(p=w*w,B=Math.max(0,b-w),w=Math.min(G-1,b+w);B<=w;++B)for(H=Math.floor(Math.sqrt(p-(B-b)*(B-b))),x=Math.max(0,r-H),H=Math.min(m-1,r+H);x<=H;++x)t[B*m+x]+=v*D[Math.abs(b-B)*q+Math.abs(r-x)];e=Number.MAX_VALUE;p=Number.MIN_VALUE;u=m-1;D=0;A=G-1;for(k=b=v=0;b<G;++b)for(r=0;r<m;++r,++k)c=f?Math.log(t[k]):t[k],0<c?(t[k]=c,e=Math.min(e,c),p=Math.max(p,c),u=Math.min(u,r),D=Math.max(D,r),A=Math.min(A,b),v=Math.max(v,b)):t[k]=0;if(d.shrinkToFit){g&&(--u,++D,--A,++v);h[1]-=u;h[3]-=
A;f=Math.max(0,D-u+1);g=Math.max(0,v-A+1);c=new Float32Array(f*g);if(c.length)for(k=b=0,u+=A*m;b<g;++b,u+=m-f)for(r=0;r<f;++r,++k,++u)c[k]=t[u];t=c;m=f;G=g}return{data:t,g:e,h:p,scale:1/(p-e),offset:-e/(p-e),width:m,height:G,transform:h,options:d}}
function eb(b,d,e,c,h,k,p){function n(){if(r<p||r===p&&.5<=p)return x=1,A--;x=0;return v++}if(0>=h)return[];var m=b.length,l=c.data,f=c.width,g=c.height,q=b.f[d],t=b.f[e],u=new Float32Array(m);for(b=0;b<m;++b)d=Math.floor(c.W(q.m(b))),e=Math.floor(c.X(t.m(b))),u[b]=l[Math.min(g-1,e)*f+Math.min(f-1,d)];m=Array.from(u.keys());m.sort(function(b,g){return u[b]-u[g]});var D=k*k,A=m.length-1,v=0,x;k=0;var r=.5,l=[m[n()]];k+=x;for(r=k/l.length;A>=v&&l.length<h;){var f=m[n()],w=c.W(q.m(f))/c.width,B=c.X(t.m(f))/
c.height;l.every(function(b){var g=c.W(q.m(b))/c.width;b=c.X(t.m(b))/c.height;return Math.pow(g-w,2)+Math.pow(b-B,2)>D})&&(l.push(f),k+=x,r=k/l.length)}return l}function hb(b,d,e,c,h,k){J(k)&&(k=.5);h=Math.min(h,b.length);for(var p=.1,n;(n=eb(b,d,e,c,h,p,k)).length<h;)p/=2;return n}
function ib(b,d,e,c,h,k,p,n){var m=h.data,l=h.width,f=h.height,g=h.scale,q=-h.offset;d=b.f[d];var t=b.f[e],q=(l+f)/2*q,g=(l+f)/2*g;p=Math.ceil(p*l);n=Math.ceil(n*f);b=h.W(d.m(c));c=h.X(t.m(c));e=Math.min(0,Math.floor(h.W(d.g))-p-1);d=Math.max(l,Math.ceil(h.W(d.h))+p+2);var u=Math.min(0,Math.floor(h.X(t.g))-n-1),t=Math.max(f,Math.ceil(h.X(t.h))+n+2),D=d-e;k.data||(k.data=new Uint8Array((k.width=d-e)*(k.height=t-u)));k=k.data;for(var A=Math.max(e,Math.floor(b)-p),v=Math.min(d,Math.floor(b)+p),x=Math.max(u,
Math.floor(c)-n),r=Math.min(t,Math.floor(c)+n);x<r;++x)for(var w=A;w<v;++w)k[(x-u)*D+(w-e)]=1;for(var A=p*p,v=n*n,r=q*q,B=null,G=Number.MAX_VALUE,H,S,x=u;x<t;++x)for(w=e;w<d;++w)0===k[(x-u)*D+(w-e)]&&(H=Math.pow(w-b,2),S=Math.pow(x-c,2),H>A&&S>v&&(H=1E10*(0<=w&&w<l&&0<=x&&x<f?Math.pow(q+m[x*l+w]*g,2):r)+(H+S),H<G&&(G=H,B=[w,x])));if(null===B)return B;A=Math.max(e,B[0]-2*p);v=Math.min(d,B[0]+2*p);x=Math.max(u,B[1]-2*n);for(r=Math.min(t,B[1]+2*n);x<r;++x)for(w=A;w<v;++w)k[(x-u)*D+(w-e)]=1;B[0]=h.ba(B[0]);
B[1]=h.ma(B[1]);return B}
function jb(b,d,e,c,h,k,p,n){var m=h.width,l=h.height,f=b.f[d],g=b.f[e];p=Math.ceil(p*m);n=Math.ceil(n*l);var q=Math.min(0,Math.floor(h.W(f.g))-p-1),t=Math.max(m,Math.ceil(h.W(f.h))+p+2),u=Math.min(0,Math.floor(h.X(g.g))-n-1),D=Math.max(l,Math.ceil(h.X(g.h))+n+2),A=t-q;k.data||(k.data=new Uint8Array((k.width=t-q)*(k.height=D-u)));var v=k.data;c.forEach(function(b){var c=Math.floor(h.W(f.m(b))),e=Math.floor(h.X(g.m(b)));b=Math.max(q,c-p);for(var c=Math.min(t,c+p),l=Math.min(D,e+n),e=Math.max(u,e-n);e<
l;++e)for(var d=b;d<c;++d)v[(e-u)*A+(d-q)]=1})}
function kb(b,d,e,c){function h(b){for(var g=0,d=0;d<p;++d)for(var h=d+1;h<p;++h)g+=Math.pow(l+e[d][h-d-1].data[b[h]*n+b[d]]*m,2);b=b.reduce(function(b,g,e){g=Math.abs(g-f[e]);return b+(g>c?Math.pow(g-c,2):Math.pow(c-g,2))});return g+b}for(var k=b.J,p=b.fa,n=e[0][0].width,m=e[0][0].scale,l=-e[0][0].offset,f=new Float32Array(p),g=0;g<p;++g)f[g]=(k[d*p+g]-b.c[g].g)*n/(b.c[g].h-b.c[g].g);var l=l*n,m=m*n,q=c=Math.ceil(c*n),t=n-c,u=[];d=new Float32Array(p);for(g=0;g<p;++g)d[g]=-1;do for(d.every(function(b){return!b})||
u.push(d.slice()),g=0;g!==d.length&&2===++d[g];)d[g]=0,++g;while(g!==d.length);var D={va:Number.MAX_VALUE},A=100;Ua({ib:function(){for(var b=new Float32Array(p),g=0;g<p;++g)b[g]=Math.max(q,Math.min(t-1,Math.floor(f[g])));return{p:b}},Va:function(){return!--A},hb:function(b,g){u.forEach(function(f){for(var c=new Float32Array(p),e=0;e<p;++e)if(c[e]=b.p[e]+f[e],c[e]<q||c[e]>=t)return;f={p:c,va:h(c)};f.va<D.va&&(D=f);g(f,f.va)})},Sa:function(b){for(var g=1,f=0,c=0;c<p;++c)f+=b.p[c]*g,g*=n;return f},vb:function(b){for(var g=
0,f=0;f<p;++f)for(var c=f+1;c<p;++c)g+=Math.pow(l+e[f][c-f-1].data[b.p[c]*n+b.p[f]]*m,2);return g}});d=D.p;for(g=0;g<p;++g)d[g]=b.c[g].g+d[g]*(b.c[g].h-b.c[g].g)/n;return d}
function lb(b,d,e,c){var h,k,p=b.data;d=b.width;e=b.height;var n=d*e;c=c.threshold*b.h;var m=new Uint32Array(n),l,f,g=[];for(h=0;h<e;++h)for(k=l=0;k<d;++k){var q=p[h*d+k];q>=c?l?(h&&(f=m[(h-1)*d+k])&&f!==l&&(g[l-1]=Qa(g[l-1],g[f-1]),g[f-1]=g[l-1],f=l),m[h*d+k]=l):h&&(f=m[(h-1)*d+k])?m[h*d+k]=l=f:g.push(new Pa(m[h*d+k]=l=g.length+1)):l=0}var t=1;for(q=0;q<g.length;++q)null===g[q]?g[q]=0:g[q]instanceof Pa&&(g[q].forEach(function(b){g[b-1]=t}),++t);f=--t;for(q=0;q<n;++q)m[q]=m[q]?g[m[q]-1]:0;p=Array.apply(null,
Array(f)).map(Number.prototype.valueOf,Number.MIN_VALUE);for(q=0;q<n;++q)if(t=m[q])p[t-1]=Math.max(p[t-1],b.data[q]);n=Array.apply(null,Array(f)).map(Number.prototype.valueOf,c);return{data:m,Ca:p,ua:n,threshold:c,n:f,width:d,height:e,transform:b.transform}}
function mb(b,d,e,c){var h=b[0],k=b[1],p=b[0]+d[0];d=b[1]+d[1];b=e[0];e=e[1];var n=c[0],m=c[1],l=(h-p)*(e-m)-(k-d)*(b-n);if(-1E-5<l&&1E-5>l)return null;c=((h*d-k*p)*(b-n)-(h-p)*(b*m-e*n))/l;h=((h*d-k*p)*(e-m)-(k-d)*(b*m-e*n))/l;k=Math.abs(n-b)>Math.abs(m-e)?(c-b)/(n-b):(h-e)/(m-e);return 0>k||1<k?null:[c,h]}
function nb(b,d,e,c){var h=[e[0]-b[0],e[1]-b[1]],k=[d[0]-b[0],d[1]-b[1]],p=[c[0]-e[0],c[1]-e[1]];c=h[0]*k[1]-h[1]*k[0];k=k[0]*p[1]-k[1]*p[0];if(!c)return 0>e[0]-b[0]!==0>e[0]-d[0]||0>e[1]-b[1]!==0>e[1]-d[1];if(!k)return!1;b=1/k;h=(h[0]*p[1]-h[1]*p[0])*b;c*=b;return 0<=h&&1>=h&&0<=c&&1>=c}
function ob(b,d){function e(b,c,e){return(c[0]-b[0])*(e[1]-b[1])-(e[0]-b[0])*(c[1]-b[1])}for(var c=d.length-1,h=0,k=0;k<c;k++)d[k][1]<=b[1]?d[k+1][1]>b[1]&&0<e(d[k],d[k+1],b)&&++h:d[k+1][1]<=b[1]&&0>e(d[k],d[k+1],b)&&--h;return!!h};function pb(b,d){var e=document.createElement("canvas");e.style.backgroundColor="transparent";e.style.pointerEvents="none";e.style.zIndex=d.style.zIndex+1;e.style.position="static";e.style.width=e.style.height="100%";d.parentElement.appendChild(e);var c=e.getContext("2d"),h=c.font,k=c.measureText("M").width;this.clear=function(){c.clearRect(0,0,d.width,d.height);c.strokeStyle=c.fillStyle=b.Ea};b.aa=function(b,e,l,f,g){e=Math.floor(e);l=Math.floor(l);switch(f){default:c.textAlign="left";f=k;break;
case "topcenter":c.textAlign="center";f=k;break;case "topright":c.textAlign="right";f=k;break;case "middleleft":c.textAlign="left";f=.53*k;break;case "middlecenter":c.textAlign="center";f=.53*k;break;case "middleright":c.textAlign="right";f=.53*k;break;case "bottomleft":c.textAlign="left";f=0;break;case "bottomcenter":c.textAlign="center";f=0;break;case "bottomright":c.textAlign="right",f=0}0==g?c.fillText(b,e,l+f):(c.save(),c.translate(e,l),c.rotate(g),c.translate(0,f),c.fillText(b,0,0),c.restore())};
b.ca=function(b){return c.measureText(b).width};b.ia=function(){return k};b.cb=function(b,e,l,f){0>l&&(b+=l,l=-l);0>f&&(e+=f,f=-f);b=Math.floor(b)+.5;e=Math.floor(e)+.5;l=Math.floor(l);f=Math.floor(f);c.strokeRect(b,e,l,f)};b.bb=function(b){if(!(2>b.length)){c.beginPath();c.moveTo(b[0][0],b[0][1]);for(var e=1;e<b.length;++e)c.lineTo(b[e][0],b[e][1]);c.closePath();c.stroke()}};b.gb=function(e){if(!(2>e.length)){c.fillStyle="rgba(255, 255, 255, 0.25)";c.beginPath();c.moveTo(e[0][0],e[0][1]);for(var d=
1;d<e.length;++d)c.lineTo(e[d][0],e[d][1]);c.closePath();c.fill();c.fillStyle=b.Ea}};this.c=function(b){c.font=h=b;var e=document.getElementsByTagName("body")[0],l=document.createElement("div");l.appendChild(document.createTextNode("M"));l.style.font=b;e.appendChild(l);k=.62*l.offsetHeight;e.removeChild(l)};this.a=function(){if(null!==p)e.width=p.width,e.height=p.height;else{var b=e.getBoundingClientRect();e.style.marginTop=-(b.bottom-b.top)+"px";e.width=b.right-b.left;e.height=b.bottom-b.top}this.c(h)};
var p=null;this.o=function(b,d){null===p&&(p={},p.width=b,p.height=d,p.ob=e,p.pb=c,e=document.createElement("canvas"),c=e.getContext("2d"),this.a())};this.j=function(){null!==p&&(e=p.ob,c=p.pb,p=null)};this.B=function(){return e};this.a()};var qb=null;
function rb(b,d,e){L(d)&&(d=d.join("\n"));L(e)&&(e=e.join("\n"));var c=b.createShader(b.VERTEX_SHADER);b.shaderSource(c,d);b.compileShader(c);if(!b.getShaderParameter(c,b.COMPILE_STATUS))return console.log(d),alert(b.getShaderInfoLog(c)),null;var h=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(h,e);b.compileShader(h);if(!b.getShaderParameter(h,b.COMPILE_STATUS))return console.log(e),alert(b.getShaderInfoLog(h)),null;var k=b.createProgram();b.attachShader(k,c);b.attachShader(k,h);b.linkProgram(k);if(!b.getProgramParameter(k,
b.LINK_STATUS))return console.log(d),console.log(e),alert(b.getProgramInfoLog(k)),null;this.$a=b.getAttribLocation(k,"vpos");this.Qa=b.getAttribLocation(k,"vnml");this.Ra=b.getAttribLocation(k,"vtng");this.Pa=b.getAttribLocation(k,"vbnml");this.za=b.getAttribLocation(k,"vtexcoord");this.ja=b.getUniformLocation(k,"uSampler");this.xa=b.getUniformLocation(k,"uSamplers");this.bind=function(){qb!==this&&(qb=this,b.useProgram(k))};this.L=function(){this.bind();var c=b.getUniformLocation(k,"flipY");return c?
function(e){this.bind();b.uniform1i(c,e)}:null};this.j=function(c){this.bind();var e=b.getUniformLocation(k,c);return e?function(c){this.bind();b.uniform1f(e,c)}:null};this.S=function(){this.bind();var c=b.getUniformLocation(k,"quadsize");return c?function(e,d){this.bind();b.uniform2f(c,e,d)}:null};this.D=function(c){this.bind();var e=b.getUniformLocation(k,c);return e?function(c){this.bind();b.uniformMatrix2fv(e,!1,c)}:null};this.B=function(c){this.bind();var e=b.getUniformLocation(k,c);return e?
function(c,l,f){this.bind();b.uniform3f(e,c,l,f)}:null};this.o=function(c){this.bind();var e=b.getUniformLocation(k,c);return e?function(c,l,f,g){this.bind();b.uniform4f(e,c,l,f,g)}:null};this.c=function(){this.bind();var c=b.getUniformLocation(k,"matWorldViewProj");return c?function(e){this.bind();b.uniformMatrix4fv(c,!1,e)}:null};this.getAttribLocation=function(c){return b.getAttribLocation(k,c)};this.T=function(){null==c&&null==h&&null==k||b.useProgram(null);null!=c&&(b.deleteShader(c),c=null);
null!=h&&(b.deleteShader(h),h=null);null!=k&&(b.deleteProgram(k),k=null)}}
function Q(b,d,e,c,h){var k,p,n,m,l,f,g,q,t,u;this.reset=function(c,e,d,h,r,w,B,G){u=G?G:3;g=B;q=Math.floor(c.length/u);t=0;k||(k=b.createBuffer());b.bindBuffer(b.ARRAY_BUFFER,k);b.bufferData(b.ARRAY_BUFFER,c,b.STATIC_DRAW);e?(p||(p=b.createBuffer()),b.bindBuffer(b.ARRAY_BUFFER,p),b.bufferData(b.ARRAY_BUFFER,e,b.STATIC_DRAW)):p||b.deleteBuffer(p);d?(n||(n=b.createBuffer()),b.bindBuffer(b.ARRAY_BUFFER,n),b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW)):n||b.deleteBuffer(n);h?(m||(m=b.createBuffer()),
b.bindBuffer(b.ARRAY_BUFFER,m),b.bufferData(b.ARRAY_BUFFER,h,b.STATIC_DRAW)):m||b.deleteBuffer(m);r?(l||(l=b.createBuffer()),b.bindBuffer(b.ARRAY_BUFFER,l),b.bufferData(b.ARRAY_BUFFER,r,b.STATIC_DRAW)):l||b.deleteBuffer(l);w?(f||(f=b.createBuffer()),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,f),b.bufferData(b.ELEMENT_ARRAY_BUFFER,w,b.STATIC_DRAW),t=w.length,"undefined"===typeof g&&(g=b.TRIANGLES)):(f||b.deleteBuffer(f),"undefined"===typeof g&&(g=b.TRIANGLE_STRIP))};d&&this.reset(d,null,null,null,e,c,h,void 0);
this.bind=function(g,c){if(k){g.bind();for(var e=0;16>e;e++)b.disableVertexAttribArray(e),b.ext&&b.ext.vertexAttribDivisorANGLE(e,0);b.enableVertexAttribArray(g.$a);b.bindBuffer(b.ARRAY_BUFFER,k);b.vertexAttribPointer(g.$a,u,b.FLOAT,!1,0,0);p&&-1!=g.Qa&&(b.enableVertexAttribArray(g.Qa),b.bindBuffer(b.ARRAY_BUFFER,p),b.vertexAttribPointer(g.Qa,u,b.FLOAT,!1,0,0));n&&-1!=g.Ra&&(b.enableVertexAttribArray(g.Ra),b.bindBuffer(b.ARRAY_BUFFER,n),b.vertexAttribPointer(g.Ra,u,b.FLOAT,!1,0,0));m&&-1!=g.Pa&&(b.enableVertexAttribArray(g.Pa),
b.bindBuffer(b.ARRAY_BUFFER,m),b.vertexAttribPointer(g.Pa,u,b.FLOAT,!1,0,0));l&&-1!=g.za&&(b.enableVertexAttribArray(g.za),b.bindBuffer(b.ARRAY_BUFFER,l),b.vertexAttribPointer(g.za,2,b.FLOAT,!1,0,0));if(c)if(L(c)){if(g.xa){for(var d=Array(e),e=0;e<c.length;e++)b.activeTexture(b.TEXTURE0+e),b.bindTexture(b.TEXTURE_2D,c[e]),d[e]=e;b.uniform1iv(g.xa,d)}}else b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,c),g.ja&&b.uniform1i(g.ja,0),g.xa&&b.uniform1iv(g.xa,[0]);f&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
f)}};this.v=function(){k&&(f?b.drawElements(g,t,b.UNSIGNED_SHORT,0):b.drawArrays(g,0,q))};this.T=function(){k&&(b.deleteBuffer(k),k=null);p&&(b.deleteBuffer(k),k=null);n&&(b.deleteBuffer(k),k=null);m&&(b.deleteBuffer(k),k=null);l&&(b.deleteBuffer(k),k=null);f&&(b.deleteBuffer(k),k=null)}}
function sb(b,d,e){var c=b.createTexture();c.image=new Image;c.image.onload=function(){b.bindTexture(b.TEXTURE_2D,c);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c.image);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindTexture(b.TEXTURE_2D,null);
"function"==typeof e&&e(c)};c.image.src=d;return c}
function tb(b,d,e,c){var h=b.createTexture();h.rb=d;b.bindTexture(b.TEXTURE_2D,h);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,e,c,0,b.RGBA,b.UNSIGNED_BYTE,d);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindTexture(b.TEXTURE_2D,null);return h}
function ub(b,d,e,c){if(null===b.getExtension("OES_texture_float"))return console.warn("GlobalView warning: The browser doesn't support floatingpoint textures"),null;var h=b.createTexture();h.ub=d;b.bindTexture(b.TEXTURE_2D,h);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,e,c,0,b.LUMINANCE,b.FLOAT,d);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,
b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindTexture(b.TEXTURE_2D,null);return h};function vb(b,d){var e=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n","precision mediump float;\nuniform vec4 color;\n\nvoid main()\n{\n\tgl_FragColor = color;\n}\n");e.color=e.o("color");e.color.apply(e,b.F);e.a=e.c();this.S=function(){e.color.apply(e,b.F)};var c=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n",
"precision mediump float;\nvarying vec2 uv;\nuniform sampler2D uSampler;\n\nvoid main()\n{\n\tgl_FragColor = texture2D(uSampler, vec2(uv.y, 0.5));\n}\n");c.a=c.c();var h=sb(b,"exhue.png",function(){d.u()});sb(b,"rainbow.png",function(){d.u()});tb(b,new Uint8Array([255,0,0,255,0,255,0,255]),2,1);var k=h,p=new Q(b,new Float32Array([0,0,0,1,0,0]),null,null,b.LINES),n=new Q(b,new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0]),null,null,b.LINE_LOOP),m=new Q(b,new Float32Array([0,1,0,0,0,0,1,1,0,1,0,0]),new Float32Array([0,
1,0,0,1,1,1,0])),l={g:0,h:100,values:null,I:0,s:10,M:11,N:6};this.a=!0;this.P=function(g,f){if(this.a){c.bind();m.bind(c,k);var d=mat4.create();mat4.identity(d);!0===g&&mat4.scale(d,d,[1,-1,1]);mat4.translate(d,d,[2*(f.x+f.width+.5)/b.width-1,2*(f.y+.5)/b.height-1,0]);mat4.scale(d,d,[20/b.width,2*f.height/b.height,1]);c.a(d);m.v();e.bind();n.bind(e,null);e.a(d);n.v();var h=0;mat4.identity(d);!0===g&&mat4.scale(d,d,[1,-1,1]);mat4.translate(d,d,[2*(f.x+f.width+10+.5)/b.width-1,2*(f.y+.5)/b.height-1,
0]);mat4.scale(d,d,[2*l.N/b.width,2*f.height/b.height,1]);e.a(d);p.v();mat4.translate(d,d,[0,1,0]);e.a(d);p.v();mat4.translate(d,d,[0,-1,0]);for(g=0;g<l.M;++g){var q=l.I+g*l.s,A=(q-l.g)/(l.h-l.g);mat4.translate(d,d,[0,A,0]);e.a(d);p.v();mat4.translate(d,d,[0,-A,0]);q=l.values?l.values[q]:q.toPrecision(6)/1;h=Math.max(h,b.ca(q));b.aa(q,f.x+f.width+10+l.N+2,b.height-f.y-f.height*A,"middleleft")}h=Math.ceil(f.x+f.width+10+l.N+10+h);l.label&&b.aa(l.label,h,b.height-f.y-f.height/2,"topcenter",-Math.PI/
2)}};this.D=function(g,c,f){l.g=g;l.h=c;l.values=null;for(var e=10;0<=e;--e){if(!1===f)l.I=Math.ceil(g/l.s)*l.s,l.M=Math.floor((c-l.I)/l.s)+1;else{l.s=(c-g)/e;for(var h=Math.ceil(Math.log(l.s)/Math.log(10)),k=0;10>k;++k){l.s=(c-g)/e;var q=Math.pow(10,h--);l.s=Math.round(l.s/q)*q;l.I=Math.ceil(g/l.s)*l.s;l.M=Math.floor((c-l.I)/l.s)+1;if(l.M>=e-2&&l.M<=e+2)break}}if(d.Ha().height*l.s/(l.h-l.g)>=b.ia()+b.ca("  "))break}};this.w=function(b,c,f){l.g=b-=.5;l.h=c-=.5;l.values=f;l.s=1;l.I=Math.max(0,Math.ceil(b/
l.s)*l.s);l.M=Math.min(f.length-l.I,Math.floor((c-l.I+1)/l.s))};this.L=function(b){l.label=b};var f=null;this.B=function(){};this.c=function(){};this.j=function(g){l.N=6+(g.showColormapHistogram?g.histogramHeight:0);g.pointColor!==f&&(f=g.pointColor,null===f?k=h:(g=wb(f))&&(k=tb(b,g,g.length/4,1)))};this.o=function(){null===l.values?this.D(l.g,l.h,!0):this.w(l.g+.5,l.h+.5,l.values)};this.ha=function(){return k};this.T=function(){p.T()}}
function xb(b){if(N(b)){if(!J(va(b)))return!0;var d;return null!==(d=Ba(b))&&0<=d.r&&255>=d.r&&0<=d.Fa&&255>=d.Fa&&0<=d.la&&255>=d.la?!0:"Unknown color "+b}return L(b)?4!==b.length?"Color array needs to have 4 components (RGBA).":!0:"Unknown color "+b}function yb(b){if(N(b)){var d=va(b);return(b=Ba(d?d:b))?new Uint8Array([b.r,b.Fa,b.la,255]):null}return L(b)?4<=b.length?new Uint8Array([b[0],b[1],b[2],b[3]]):null:null}
function zb(b){if(null===b)return!0;if(N(b))return xb(b);if(L(b)){if(0===b.length)return"Colormap array cannot be empty.";if(N(b[0]))for(var d,e=0;e<b.length;++e){if(!0!==(d=xb(b[e])))return d}else{if(b.length%4)return"Colormap array length must be multiple of 4.";for(e=0;e<b.length;++e)if(!ra(b[e])||0>b[e]||255<b[e])return"Colormap array must contain numbers between 0 and 255."}return!0}return"Unknown colormap "+b}
function wb(b){if(N(b))return yb(b);if(L(b)){if(0===b.length)return null;if(N(b[0])){for(var d=[],e,c=0;c<b.length;++c)if(e=yb(b[c]))Array.prototype.push.apply(d,e);else return null;return new Uint8Array(d)}if(ra(b[0]))return new Uint8Array(b)}return null};function Ab(b,d){function e(c){var e=b.ca("  ");switch(c){case 0:c=k[0];for(var f=Number.MIN_VALUE,g=d.Ha(),h=0;h<c.M;++h){var m=c.I+h*c.s,n=b.ca(c.values?c.values[m]:m.toPrecision(6)/1),m=g.x+(m-c.g)/(c.h-c.g)*g.width-n/2;if(m<f+e)return!1;f=m+n}return!0;case 1:return c=k[1],g=d.Ha(),g.height*c.s/(c.h-c.g)>=b.ia()+e;default:return!0}}var c=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n",
"precision mediump float;\nuniform vec4 color;\n\nvoid main()\n{\n\tgl_FragColor = color;\n}\n");c.color=c.o("color");c.color.apply(c,b.F);c.a=c.c();this.S=function(){c.color.apply(c,b.F)};var h=new Q(b,new Float32Array([0,0,0,1,0,0]),null,null,b.LINES),k=[{g:0,h:100,values:null,I:0,s:10,M:11,N:6},{g:0,h:100,values:null,I:0,s:10,M:11,N:6}],p=0,n=0;this.a=[!0,!0];this.P=function(e,d){var f=mat4.create();c.bind();h.bind(c,null);this.a[0]&&(mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,
f,[2*(d.x+.5)/b.width-1,2*(d.y+.5)/b.height-1,0]),mat4.scale(f,f,[2*d.width/b.width,1,1]),c.a(f),h.v());this.a[1]&&(mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[2*(d.x+.5)/b.width-1,2*(d.y+.5)/b.height-1,0]),mat4.rotateZ(f,f,Math.PI/2),mat4.scale(f,f,[2*d.height/b.height,1,1]),c.a(f),h.v());p=0;if(this.a[0]){var g=k[0];mat4.identity(f);!0===e&&mat4.scale(f,f,[1,-1,1]);mat4.translate(f,f,[2*(d.x+.5)/b.width-1,2*(d.y+.5)/b.height-1,0]);mat4.rotateZ(f,f,-Math.PI/2);mat4.scale(f,
f,[2*g.N/b.height,2*d.width/b.width,1]);c.a(f);h.v();mat4.translate(f,f,[0,1,0]);c.a(f);h.v();mat4.translate(f,f,[0,-1,0]);for(var l=0;l<g.M;++l){var m=g.I+l*g.s;var u=(m-g.g)/(g.h-g.g);mat4.translate(f,f,[0,u,0]);c.a(f);h.v();mat4.translate(f,f,[0,-u,0]);m=g.values?g.values[m]:m.toPrecision(6)/1;b.aa(m,d.x+d.width*u,b.height-d.y+g.N+2,"topcenter")}p=b.height-d.y+g.N+10+b.ia()}n=0;if(this.a[1]){g=k[1];mat4.identity(f);!0===e&&mat4.scale(f,f,[1,-1,1]);mat4.translate(f,f,[2*(d.x+.5)/b.width-1,2*(d.y+
.5)/b.height-1,0]);mat4.scale(f,f,[-2*g.N/b.width,2*d.height/b.height,1]);c.a(f);h.v();mat4.translate(f,f,[0,1,0]);c.a(f);h.v();mat4.translate(f,f,[0,-1,0]);for(l=0;l<g.M;++l)e=g.I+l*g.s,u=(e-g.g)/(g.h-g.g),mat4.translate(f,f,[0,u,0]),c.a(f),h.v(),mat4.translate(f,f,[0,-u,0]),m=g.values?g.values[e]:e.toPrecision(6)/1,n=Math.max(n,b.ca(m)),b.aa(m,d.x-g.N-2,b.height-d.y-d.height*u,"middleright");n=Math.ceil(d.x-g.N-10-n)}this.a[0]&&k[0].label&&b.aa(k[0].label,d.x+d.width/2,p,"topcenter");this.a[1]&&
k[1].label&&b.aa(k[1].label,n,b.height-d.y-d.height/2,"bottomcenter",-Math.PI/2)};this.D=function(b,c,f,g){var d=k[b];d.g=c;d.h=f;d.values=null;for(var l=10;0<=l;--l){if(!1===g)d.I=Math.ceil(c/d.s)*d.s,d.M=Math.floor((f-d.I)/d.s)+1;else{d.s=(f-c)/l;for(var h=Math.ceil(Math.log(d.s)/Math.log(10)),m=0;10>m;++m){d.s=(f-c)/l;var n=Math.pow(10,h--);d.s=Math.round(d.s/n)*n;d.I=Math.ceil(c/d.s)*d.s;d.M=Math.floor((f-d.I)/d.s)+1;if(d.M>=l-2&&d.M<=l+2)break}}if(e(b))break}};this.w=function(b,c,f,g){b=k[b];
b.g=c-=.5;b.h=f-=.5;b.values=g;b.s=1;b.I=Math.max(0,Math.ceil(c/b.s)*b.s);b.M=Math.min(g.length-b.I,Math.floor((f-b.I+1)/b.s))};this.L=function(b,c){k[b].label=c};this.B=function(){};this.c=function(){};this.j=function(b){k[0].N=6+(b.showXAxisHistogram?b.histogramHeight:0);k[1].N=6+(b.showYAxisHistogram?b.histogramHeight:0)};this.o=function(){for(var b=0;2>b;++b)null===k[b].values?this.D(b,k[b].g,k[b].h,!0):this.w(b,k[b].g+.5,k[b].h+.5,k[b].values)};this.ya=function(c,e){if(this.a[0]){var f=b.ca(k[0].label)/
2;var g=c.x+c.width/2;if(e[0]>=g-f&&e[0]<g+f&&e[1]>=p&&e[1]<=p+b.ia()+2)return 0}return this.a[1]&&(f=b.ca(k[1].label)/2,g=b.height-c.y-c.height/2,e[0]>=n-b.ia()&&e[0]<=n+2&&e[1]>=g-f&&e[1]<g+f)?1:null};this.ha=function(c,e){switch(e){case 0:if(!this.a[0])break;e=b.ca(k[0].label)/2;c=c.x+c.width/2;return{l:c-e,r:c+e,t:p,b:p+b.ia()+2};case 1:if(this.a[1])return e=b.ca(k[1].label)/2,c=b.height-c.y-c.height/2,{l:n-b.ia(),r:n+2,t:c-e,b:c+e}}return null};this.T=function(){h.T()}};function Bb(b,d){function e(){Sa.call(this,function(){b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.get(),b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);d.u()});var c=b.createBuffer();this.P=function(b){this.size()===h.length?k.v(b,0,h.length):this.size()&&k.w(b,c,this.size())};this.qb=function(b,c){if(this.size()===h.length)k.j(b,c,0,h.length);else if(this.size()){var g=0,e=-1,f=0;this.forEach(function(d){d===e+1?++f:(f&&k.j(b,c,g,f),g=d,f=1);e=d});f&&
k.j(b,c,g,f)}};this.T=function(){-1!==c&&(b.deleteBuffer(c),c=-1)}}function c(b,c,e,d,h){var g=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,new Float32Array([0,-1,0,1,2,1,2,-1]),b.STATIC_DRAW);for(var f=new Float32Array(e),k=0;k<e;++k)f[k]=k;var q=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,q);b.bufferData(b.ARRAY_BUFFER,f,b.STATIC_DRAW);this.B=function(b){for(var c="\n{0}\nuniform vec{1} offsets, scales, animatedScales;\nuniform float n;\n#define PI 3.14159265359\nvec{1} getPos()\n{\n\treturn offsets + vec{1}({2}) * scales + vec{1}({3}) * animatedScales;\n}\n",
g="",e=[/c(\d+)/g,"0.0"],f=[],h=[],k=0,q=0;k<d;k+=4,++q)for(var n=Math.min(4,d-k),g=g+("attribute "+(1==n?"float":"vec"+n)+" p"+q+";\n"),p=0;p<n;++p)e.push("p"+q+(1==n?"":"["+p+"]"));for(k=0;k<U;++k)f.push(String.prototype.a.apply(m[k]?m[k].Ja:"0.0",e)),h.push(String.prototype.a.apply(m[k]?l[k].Ja:"0.0",e));g+="attribute float i;\n";return c=b?c.format(g,4,f.slice(0,4).join(", "),h.slice(0,4).join(", ")):c.format(g,3,f.slice(0,3).join(", "),h.slice(0,3).join(", "))};this.c=this.a=null;this.o=function(c){null!==
this.a&&this.a.T();null!==this.c&&this.c.T();var g="float opacityMap(in vec2 p) ";switch(c.pointShape){case "Circle":g+="{ return 1.0 - pow(p.x*p.x + p.y*p.y, pointSize / 4.0); }";break;case "Cross":g+="{ return pointSize / 4.0 * (max(4.0 / pointSize - abs(p.x - p.y), 0.0) + max(4.0 / pointSize - abs(-p.x - p.y), 0.0)); }";break;case "Diamond":g+="{ return 1.0 - pow(abs(p.x) + abs(p.y), 2.0 + pointSize / 4.0); }";break;case "Gaussian":g+="{ return exp(-7.0 * (p.x*p.x + p.y*p.y)); }";break;case "Custom":g+=
c.customPointShape;break;default:g+="{ return 1.0; }"}this.a=new rb(b,[this.B(!1),"uniform sampler2D uSampler;\nuniform float pointOpacity, pointSize;\nuniform bool flipY;\nvarying vec4 color;\n\nvoid main()\n{\n\tvec3 pos = getPos();\n\tcolor = texture2D(uSampler, vec2(pos.z, 0.5));\n\tcolor.a *= pointOpacity;\n\tgl_Position = vec4(pos.x, flipY ? -pos.y : pos.y, 0.0, 1.0);\n\tgl_PointSize = pointSize;\n}\n"],["precision highp float; uniform float pointSize;",g,"varying vec4 color;\n\nvoid main()\n{\n\t//float t = clamp(1.0 - length(gl_PointCoord * 2.0 - 1.0), 0.0, 1.0);\n\tgl_FragColor = vec4(color.rgb, color.a * clamp(opacityMap(gl_PointCoord * 2.0 - 1.0), 0.0, 1.0));\n}\n"]);
this.a.Ma=this.a.B("offsets");this.a.Oa=this.a.B("scales");this.a.Aa=this.a.B("animatedScales");this.a.Da=this.a.L();this.a.ha=this.a.S();this.a.ra=this.a.j("pointOpacity");this.a.ra(c.pointOpacity);this.a.wa=this.a.j("pointSize");this.a.wa(c.pointSize);this.a.n=this.a.j("n");this.a.n&&this.a.n(e);this.a.U=[this.a.getAttribLocation("p0"),this.a.getAttribLocation("p1"),this.a.getAttribLocation("p2"),this.a.getAttribLocation("p3")];this.a.Y=this.a.getAttribLocation("i");this.c=new rb(b,[this.B(!0),
"uniform sampler2D uSampler;\nuniform float pointOpacity, pointSize;\nuniform bool flipY;\nuniform mat2 lineTransform;\nattribute vec2 lineOffset;\nvarying vec4 color;\n\nvoid main()\n{\n\tvec4 pos = getPos();\n\tcolor = texture2D(uSampler, vec2(pos.z, 0.5));\n\tcolor.a *= pointOpacity;\n\tgl_Position = vec4(pos.x, flipY ? -pos.y : pos.y, 0.0, 1.0) + vec4(lineOffset * vec2(pos.w, 1.0) * lineTransform, 0.0, 0.0);\n\tgl_PointSize = pointSize;\n}\n"],["precision highp float; uniform float pointSize;",
g,"varying vec4 color;\n\nvoid main()\n{\n\tgl_FragColor = color;\n}\n"]);this.c.Ma=this.c.o("offsets");this.c.Oa=this.c.o("scales");this.c.Aa=this.c.o("animatedScales");this.c.Da=this.c.L();this.c.ha=this.c.S();this.c.ra=this.c.j("pointOpacity");this.c.ra(c.pointOpacity);this.c.wa=this.c.j("pointSize");this.c.wa(c.pointSize);this.c.n=this.c.j("n");this.c.n&&this.c.n(e);this.c.U=[this.c.getAttribLocation("p0"),this.c.getAttribLocation("p1"),this.c.getAttribLocation("p2"),this.c.getAttribLocation("p3")];
this.c.Y=this.c.getAttribLocation("i");this.c.La=this.c.getAttribLocation("lineOffset");this.c.mb=this.c.D("lineTransform")};m&&l&&this.o(h);this.v=function(g,f,h){"undefined"===typeof f&&(f=0);"undefined"===typeof h&&(h=e);for(var l=0;16>l;l++)b.disableVertexAttribArray(l),b.ext&&b.ext.vertexAttribDivisorANGLE(l,0);if(c){b.bindBuffer(b.ARRAY_BUFFER,c);for(var k=0,l=0;k<d;k+=4,++l)-1!==this.a.U[l]&&(b.enableVertexAttribArray(this.a.U[l]),b.vertexAttribPointer(this.a.U[l],Math.min(4,d-k),b.FLOAT,!1,
4*d,4*(f*d+k)))}-1!==this.a.Y&&(b.bindBuffer(b.ARRAY_BUFFER,q),b.enableVertexAttribArray(this.a.Y),b.vertexAttribPointer(this.a.Y,1,b.FLOAT,!1,4,4*f));g&&this.a.ja&&(b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,g),b.uniform1i(this.a.ja,0));b.drawArrays(b.POINTS,0,Math.min(h,e-f))};this.w=function(g,e,f){for(var h=0;16>h;h++)b.disableVertexAttribArray(h),b.ext&&b.ext.vertexAttribDivisorANGLE(h,0);if(c){b.bindBuffer(b.ARRAY_BUFFER,c);for(var l=0,h=0;l<d;l+=4,++h)-1!==this.a.U[h]&&(b.enableVertexAttribArray(this.a.U[h]),
b.vertexAttribPointer(this.a.U[h],Math.min(4,d-l),b.FLOAT,!1,4*d,4*l))}-1!==this.a.Y&&(b.bindBuffer(b.ARRAY_BUFFER,q),b.enableVertexAttribArray(this.a.Y),b.vertexAttribPointer(this.a.Y,1,b.FLOAT,!1,4,0));g&&this.a.ja&&(b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,g),b.uniform1i(this.a.ja,0));b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e);b.drawElements(b.POINTS,f,b.UNSIGNED_INT,0)};this.j=function(f,l,k,n){"undefined"===typeof k&&(k=0);"undefined"===typeof n&&(n=e);for(var m=0;16>m;m++)b.disableVertexAttribArray(m),
b.ext.vertexAttribDivisorANGLE(m,0);if(c){b.bindBuffer(b.ARRAY_BUFFER,c);for(var p=0,m=0;p<d;p+=4,++m)-1!==this.c.U[m]&&(b.enableVertexAttribArray(this.c.U[m]),b.vertexAttribPointer(this.c.U[m],Math.min(4,d-p),b.FLOAT,!1,4*d,4*(k*d+p)),b.ext.vertexAttribDivisorANGLE(this.c.U[m],1))}-1!==this.a.Y&&(b.bindBuffer(b.ARRAY_BUFFER,q),b.enableVertexAttribArray(this.a.Y),b.vertexAttribPointer(this.c.Y,1,b.FLOAT,!1,4,4*k),b.ext.vertexAttribDivisorANGLE(this.c.Y,1));f&&this.c.ja&&(b.activeTexture(b.TEXTURE0),
b.bindTexture(b.TEXTURE_2D,f),b.uniform1i(this.c.ja,0));f=mat2.create();mat2.scale(f,f,vec2.fromValues(Math.sqrt(l[0]*l[0]+l[1]*l[1]),Math.max(1,h.pointSize)));mat2.rotate(f,f,Math.atan2(l[1],l[0]));mat2.scale(f,f,vec2.fromValues(1/b.width,1/b.height));this.c.mb(f);b.bindBuffer(b.ARRAY_BUFFER,g);b.enableVertexAttribArray(this.c.La);b.vertexAttribPointer(this.c.La,2,b.FLOAT,!1,0,0);b.ext.vertexAttribDivisorANGLE(this.c.La,0);b.ext.drawArraysInstancedANGLE(b.TRIANGLE_FAN,0,4,Math.min(n,e-k))};this.T=
function(){b.bindBuffer(b.ARRAY_BUFFER,null);c&&b.deleteBuffer(c);c=null;b.deleteBuffer(g);g=null;this.a&&this.a.T()}}var h,k=null,p=1,n=[this.a=new e];this.w=function(c,g){var d=new e;if(c){var f;if(!0===(f=zb(c))){if(c=wb(c))d.sa=tb(b,c,c.length/4,1)}else console.warn("GlobalView warning: Invalid value for point set color: "+c),N(f)&&console.warn("                    "+f)}d.opacity=g;n.push(d);return d};this.L=function(b){b=n.indexOf(b);-1!==b&&n.splice(b,1)};this.P=function(b,c,e,d){null!==k&&
(k.a.bind(),k.a.Ma.apply(k.a,c.Ga()),k.a.Oa.apply(k.a,c.Ia()),k.a.Aa.apply(k.a,c.Ua()),k.a.Da(b?1:0),n.forEach(function(b){k.a.ra(b.opacity?b.opacity:p);b.P(b.sa?b.sa:e)}),d&&(k.c.bind(),k.c.Ma.apply(k.c,c.Ga()),k.c.Oa.apply(k.c,c.Ia()),k.c.Aa.apply(k.c,c.Ua()),k.c.Da(b?1:0),n.forEach(function(b){k.c.ra(b.opacity?b.opacity:Math.max(.1,p/2));b.qb(b.sa?b.sa:e,d)})))};this.B=function(e,g){k&&k.T();n.forEach(function(b){return b.clear()});h=e;p=g.pointOpacity;if(e.J.length!==e.length*e.fa)alert("'dataset.fdata.length !== dataset.length * dataset.numColumns'");
else{if(e.fa){var d=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,d);b.bufferData(b.ARRAY_BUFFER,new Float32Array(e.J),b.STATIC_DRAW)}else d=null;k=new c(b,d,e.length,e.fa,g);this.a.c(e.length)}};this.j=function(b,c){p=b.pointOpacity;k&&(!0===c?k.o(b):k.a.wa(b.pointSize))};var m=null,l=null;this.c=function(b,c,e){m=b.map(function(b){return h.f[b]});l=c.map(function(b){return h.f[b.origin]});k&&k.o(e)};this.o=function(){}};var V=12,Cb=16.5;
function Db(b){this.j=this.w=this.c=this.A=this.ka=null;this.highlighted=!1;this.D=-1;this.getPoint=function(){return this.D};this.a=null;this.getBorderColor=function(){return this.a?this.a.slice():null};this.setBorderColor=function(d){this.a=d;b.u()};this.B=null;this.getLineColor=function(){return this.B?this.B.slice():null};this.setLineColor=function(d){this.B=d;b.u()};this.o=null;this.getLabelColor=function(){return this.o?this.o.slice():null};this.setLabelColor=function(d){this.o=d;b.u()}}
qa("Thumbnail",Db);
function Eb(b,d){function e(c){return 2*(Math.floor(c*b.height/2)+.5)/b.height}var c=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n","precision mediump float;\nvarying vec2 uv;\nuniform sampler2D uSampler;\n\nvoid main()\n{\n\tgl_FragColor = texture2D(uSampler, uv);\n}\n");c.a=c.c();var h=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n","precision mediump float;\nuniform vec4 color;\n\nvoid main()\n{\n\tgl_FragColor = color;\n}\n");
h.color=h.o("color");h.color.apply(h,b.F);h.a=h.c();var k=new Q(b,new Float32Array([0,0,0,1,0,0]),null,null,b.LINES),p=new Q(b,new Float32Array([0,1,0,0,0,0,1,1,0,1,0,0]),new Float32Array([0,1,0,0,1,1,1,0])),n=new Q(b,new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]),null,null,b.LINE_LOOP);V=b.ia()+4;Cb=b.ca("888")+4;var m=new Q(b,new Float32Array([0,0,0,.5*V,.5*V,0,.5*V+Cb,.5*V,0,.5*V+Cb,-.5*V,0,.5*V,-.5*V,0]),null,null,b.TRIANGLE_FAN),l=new Q(b,new Float32Array([0,0,0,.5*V,.5*V,0,.5*V+Cb,.5*V,0,.5*V+
Cb,-.5*V,0,.5*V,-.5*V,0]),null,null,b.LINE_LOOP),f=[];this.P=function(d,A){if(f.length){var v=mat4.create(),x=vec2.create(),r=vec2.create(),w=vec2.create();if(g.labelThumbnails){var B=1;f.forEach(function(c){c.A!==c.c&&(A.R(r,c.c),h.bind(),mat4.identity(v),!0===d&&mat4.scale(v,v,[1,-1,1]),r[0]=2*(Math.floor(r[0]*b.width/2)+.5)/b.width,r[1]=e(r[1]),mat4.translate(v,v,[r[0],r[1],0]),mat4.scale(v,v,[2/b.width,2/b.height,1]),h.a(v),h.color.apply(h,c.highlighted?[1,1,0,1]:c.o?c.o:u),m.bind(h,null),m.v(),
h.color.apply(h,c.a?c.a:q),l.bind(h,null),l.v(),r[0]=(1+r[0])*b.width/2,r[1]=(1-r[1])*b.height/2,r[0]+=.5*V+Cb-2,r[1]-=.5*V-2,b.aa(B++,r[0],r[1],"topright"))})}else h.bind(),k.bind(h,null),f.forEach(function(b){if(b.A&&b.A!==b.c){mat4.identity(v);!0===d&&mat4.scale(v,v,[1,-1,1]);A.R(x,b.A);A.R(r,b.c);mat4.translate(v,v,[x[0],x[1],0]);var c=r[0]-x[0],e=r[1]-x[1];mat4.rotateZ(v,v,Math.atan2(e,c));mat4.scale(v,v,[Math.sqrt(c*c+e*e),1,1]);h.a(v);h.color.apply(h,b.B?b.B:t);k.v()}});c.bind();B=1;f.forEach(function(f){if(f.A){A.R(x,
f.A);A.Ya(w,f.w);var l=f.ka.image.width,k=f.ka.image.height,l=Math.max(w[0],w[0]*k/l,1)<Math.max(w[1]*l/k,w[1])?[2*Math.floor(w[0])/b.width,2*Math.floor(w[0]*k/l)/b.height,1]:[2*Math.floor(w[1]*l/k)/b.width,2*Math.floor(w[1])/b.height,1];p.bind(c,f.ka);mat4.identity(v);!0===d&&mat4.scale(v,v,[1,-1,1]);x[0]=2*(Math.floor(x[0]*b.width/2)+.5)/b.width;mat4.translate(v,v,[x[0],e(x[1]),0]);mat4.scale(v,v,l);mat4.translate(v,v,f.j);c.a(v);p.v();n.bind(h,null);h.a(v);h.color.apply(h,f.a?f.a:q);n.v();g.labelThumbnails&&
(mat4.identity(v),!0===d&&mat4.scale(v,v,[1,-1,1]),x[0]+=f.j[0]*l[0],x[1]+=f.j[1]*l[1],mat4.translate(v,v,[x[0],e(x[1]),0]),l[1]=2*V/b.height,l[1]=e(l[1]),mat4.scale(v,v,l),mat4.translate(v,v,[-0,-1,0]),h.a(v),h.color.apply(h,f.highlighted?[1,1,0,1]:f.o?f.o:u),p.bind(h,null),p.v(),h.color.apply(h,f.a?f.a:q),n.bind(h,null),n.v(),x[0]+=1*l[0]-4/b.width,x[1]-=4/b.height,x[1]=e(x[1]),b.aa(B++,b.width*(1+x[0])/2,b.height*(1-x[1])/2,"topright"))}})}};var g={},q=b.F,t=b.F,u=b.pa;this.B=function(){};this.c=
function(){};this.j=function(c){g=c;q=g.thumbnailBorderColor?(new Float32Array(yb(g.thumbnailBorderColor))).map(function(b){return b/255}):b.F;t=g.thumbnailLineColor?(new Float32Array(yb(g.thumbnailLineColor))).map(function(b){return b/255}):b.F;u=g.thumbnailLabelColor?(new Float32Array(yb(g.thumbnailLabelColor))).map(function(b){return b/255}):b.pa};this.o=function(){};this.a=function(c,e,g,l,h,k){switch(k){case "topleft":k=[-0,-1,0];break;case "topcenter":k=[-.5,-1,0];break;case "topright":k=[-1,
-1,0];break;case "middleleft":k=[-0,-.5,0];break;default:k=[-.5,-.5,0];break;case "middleright":k=[-1,-.5,0];break;case "bottomleft":k=[-0,-0,0];break;case "bottomcenter":k=[-.5,-0,0];break;case "bottomright":k=[-1,-0,0]}var q=new Db(d);q.ka=sb(b,c,function(){d.u()});q.A=l;q.D=e;q.c=g;q.w=h;q.j=k;q.a=null;f.push(q)};this.w=function(){f=[]};this.D=function(){return f};this.S=function(b){for(var c,e=vec2.create(),g=vec2.create(),d=vec2.create(),l=vec2.create(),h=1;h<f.length;++h)if(f[h].A){b.R(e,f[h].A);
b.R(g,f[h].c);for(var k=0;k<h;++k)if(f[k].A&&(b.R(d,f[k].A),b.R(l,f[k].c),vec2.sqrDist(e,g)+vec2.sqrDist(d,l)>vec2.sqrDist(e,l)+vec2.sqrDist(d,g)&&!nb(e,l,d,g))){c=f[k].A;f[k].A=f[h].A;f[h].A=c;h=0;break}}for(h=1;h<f.length;++h)if(f[h].A)for(b.R(e,f[h].A),b.R(g,f[h].c),k=0;k<h;++k)if(f[k].A&&(b.R(d,f[k].A),b.R(l,f[k].c),nb(e,g,d,l))){c=f[k].A;f[k].A=f[h].A;f[h].A=c;h=0;break}};this.L=function(c,e){var d=vec2.create();vec2.create();var l=vec2.create(),h=null;f.forEach(function(f){if(f.A){c.R(d,f.A);
c.Ya(l,f.w);var k=f.ka.image.width,q=f.ka.image.height,k=Math.max(l[0],l[0]*q/k,1)<Math.max(l[1]*k/q,l[1])?[2*Math.floor(l[0])/b.width,2*Math.floor(l[0]*q/k)/b.height,1]:[2*Math.floor(l[1]*k/q)/b.width,2*Math.floor(l[1])/b.height,1],k=[d[0]+f.j[0]*k[0],d[0]+(f.j[0]+1)*k[0],d[1]+f.j[1]*k[1],d[1]+(f.j[1]+1)*k[1]];g.labelThumbnails&&(k[2]-=2*V/b.height);e[0]>=k[0]&&e[0]<=k[1]&&e[1]>=k[2]&&e[1]<=k[3]&&(h=f)}});return h}};function Fb(b,d){var e=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nuniform mat2 matTexCoordTransform;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = matTexCoordTransform * vtexcoord;\n}\n","precision mediump float;\nvarying vec2 uv;\nuniform float scale;\nuniform vec3 color;\nuniform sampler2D uSamplers[2];\n\nvoid main()\n{\n\tfloat depth = texture2D(uSamplers[0], uv).r * scale;\n\t//gl_FragColor = vec4(texture2D(uSamplers[1], vec2(depth, 0.5)).rgb, 1.0);\n\tgl_FragColor = vec4(color, depth);\n}\n");
e.a=e.c();e.w=e.D("matTexCoordTransform");e.scale=e.j("scale");e.color=e.B("color");sb(b,"cmDensityMap.png",function(){d.u()});var c=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nuniform mat2 matTexCoordTransform;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = matTexCoordTransform * vtexcoord;\n}\n","precision mediump float;\nvarying vec2 uv;\nuniform sampler2D uSampler;\n\nvoid main()\n{\n\tgl_FragColor = texture2D(uSampler, uv);\n}\n");
c.a=c.c();c.w=c.D("matTexCoordTransform");var h=new Q(b,new Float32Array([0,1,0,0,0,0,1,1,0,1,0,0]),new Float32Array([0,1,0,0,1,1,1,0])),k=null,p=new $a;this.D=function(b){this.a&&p.threshold!==b?(p.threshold=b,k.Na(d.Ta(0),d.Ta(1),p,function(){d.u()})):p.threshold=b};this.w=this.a=!1;this.P=function(n,m,l,f){var g=vec2.create();if(this.w)if(k&&k.kb(l,f)){var q=k.Na(l,f,p);if(0!==q.width&&0!==q.height){var t=this.a?q.eb:q.ka;if(!t){t=this.a?k.ga(l,f,void 0,void 0):null;var u=new Uint8Array(4*q.data.length);
for(var D=0;D<q.data.length;++D){var A=q.data[D];if(0===A)u[4*D+0]=0,u[4*D+1]=0,u[4*D+2]=0,u[4*D+3]=0;else{--A;var v=t?(t.data[D]-q.ua[A])/(q.Ca[A]-q.ua[A]):.75;0>v&&(v=0);A=(A+.5)/q.n;1<A&&--A;A=[A,.5,1];A=Da(A);u[4*D+0]=Math.floor(255*A[0]);u[4*D+1]=Math.floor(255*A[1]);u[4*D+2]=Math.floor(255*A[2]);u[4*D+3]=Math.floor(255*v)}}t=tb(b,u,q.width,q.height);this.a?q.eb=t:q.ka=t}c.bind();h.bind(c,t);u=mat4.create();!0===n&&mat4.scale(u,u,[1,-1,1]);m.Z(g,l>f?[q.ma(0),q.ba(0)]:[q.ba(0),q.ma(0)]);mat4.translate(u,
u,[g[0],g[1],0]);m.Ba(g,l>f?[q.height/q.transform[2],q.width/q.transform[0]]:[q.width/q.transform[0],q.height/q.transform[2]]);mat4.scale(u,u,[g[0],g[1],1]);c.a(u);c.w(new Float32Array(l>f?[0,1,1,0]:[1,0,0,1]));h.v()}}else k.Na(l,f,p,function(){d.u()});else this.a&&(k&&k.lb(l,f)?(t=k.ga(l,f,void 0,void 0),0!==t.width&&0!==t.height&&(t.a||(t.a=ub(b,t.data,t.width,t.height)),e.bind(),h.bind(e,[t.a]),u=mat4.create(),!0===n&&mat4.scale(u,u,[1,-1,1]),m.Z(g,l>f?[t.ma(0),t.ba(0)]:[t.ba(0),t.ma(0)]),mat4.translate(u,
u,[g[0],g[1],0]),m.Ba(g,l>f?[t.height/t.transform[2],t.width/t.transform[0]]:[t.width/t.transform[0],t.height/t.transform[2]]),mat4.scale(u,u,[g[0],g[1],1]),e.a(u),e.w(new Float32Array(l>f?[0,1,1,0]:[1,0,0,1])),e.scale(1/t.h),e.color(b.F[0],b.F[1],b.F[2]),h.v())):k.ga(l,f,void 0,void 0,function(){d.u()}))};this.B=function(b){k=b};this.c=function(){};this.j=function(){};this.o=function(){}};function Gb(b){function d(){if(k&&0<n.histogramHeight){var b=n.numHistogramBins;n.showXAxisHistogram&&e(m[0],k,p[0],b);n.showYAxisHistogram&&e(m[1],k,p[1],b);n.showColormapHistogram&&e(m[2],k,p[2],b)}}function e(c,e,g,d){if(!(0>g||g>=e.f.length||c.C&&c.C.width===d&&c.d===g)){c.C=bb(e,c.d=g,d);Va(c.C);var f=new Float32Array(18*d);g=function(b,c,e){b*=3;f[b++]=c;f[b++]=e;f[b++]=0};for(var h=0,l=-1,k=1/d;h<d;++h)e=c.C.data[h]/c.C.h,g(++l,(h+0)*k,0),g(++l,(h+1)*k,0),g(++l,(h+1)*k,e),g(++l,(h+1)*k,e),
g(++l,(h+0)*k,e),g(++l,(h+0)*k,0);c.da.reset(f,null,null,null,null,null,b.TRIANGLES);f=new Float32Array(3*(3*d+1));g(0,0,0);l=h=0;for(k=1/d;h<d;)e=c.C.data[h]/c.C.h,g(++l,h*k,e),g(++l,++h*k,e),g(++l,h*k,0);c.ea.reset(f,null,null,null,null,null,b.LINE_STRIP)}}var c=new rb(b,"attribute vec3 vpos;\nattribute vec2 vtexcoord;\nuniform mat4 matWorldViewProj;\nvarying vec2 uv;\n\nvoid main()\n{\n\tgl_Position = matWorldViewProj * vec4(vpos, 1.0);\n\tuv = vtexcoord;\n}\n","precision mediump float;\nuniform vec4 color;\n\nvoid main()\n{\n\tgl_FragColor = color;\n}\n");
c.color=c.o("color");c.color.apply(c,b.F);c.a=c.c();var h=new Q(b,new Float32Array([0,0,0,1,0,0]),null,null,b.LINES),k=null,p=null,n={},m=[{C:null,d:-1,da:new Q(b,new Float32Array(0),null,null,b.TRIANGLES),ea:new Q(b,new Float32Array(0),null,null,b.LINE_STRIP)},{C:null,d:-1,da:new Q(b,new Float32Array(0),null,null,b.TRIANGLES),ea:new Q(b,new Float32Array(0),null,null,b.LINE_STRIP)},{C:null,d:-1,da:new Q(b,new Float32Array(0),null,null,b.TRIANGLES),ea:new Q(b,new Float32Array(0),null,null,b.LINE_STRIP)}];
this.P=function(e,d,g){var f=mat4.create(),l=vec3.create(),k=vec3.create();d.Z(l,[m[0].C?m[0].C.ba(0):0,m[1].C?m[1].C.ba(0):0,m[2].C?m[2].C.ba(0):0]);d.Ba(k,[m[0].C?m[0].C.width/m[0].C.transform[0]:1,m[1].C?m[1].C.width/m[1].C.transform[0]:1,m[2].C?m[2].C.width/m[2].C.transform[0]:1]);l[2]=2*(g.y+g.height*l[2])/b.height-1;k[2]=g.height*k[2]*2/b.height;n.showXAxisHistogram&&m[0].C&&(d=m[0],b.enable(b.SCISSOR_TEST),b.scissor(g.x,0,g.width,b.height),c.bind(),h.bind(c,null),mat4.identity(f),!0===e&&mat4.scale(f,
f,[1,-1,1]),mat4.translate(f,f,[2*(g.x+.5)/b.width-1,2*(g.y+.5-64)/b.height-1,0]),mat4.scale(f,f,[2*g.width/b.width,1,1]),c.a(f),h.v(),mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[l[0]+1/b.width,2*(g.y+.5)/b.height-1,0]),mat4.scale(f,f,[k[0],-128/b.height,1]),c.bind(),c.a(f),c.color.apply(c,[b.F[0],b.F[1],b.F[2],.5]),d.da.bind(c,null),d.da.v(),c.color.apply(c,b.F),d.ea.bind(c,null),d.ea.v(),b.disable(b.SCISSOR_TEST));n.showYAxisHistogram&&m[1].C&&(d=m[1],b.enable(b.SCISSOR_TEST),
b.scissor(0,e?b.height-g.y-g.height:g.y,b.width,g.height),c.bind(),h.bind(c,null),mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[2*(g.x+.5-64)/b.width-1,2*(g.y+.5)/b.height-1,0]),mat4.rotateZ(f,f,Math.PI/2),mat4.scale(f,f,[2*g.height/b.height,1,1]),c.a(f),h.v(),mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[2*(g.x+.5)/b.width-1,l[1]+1/b.height,0]),mat4.rotateZ(f,f,Math.PI/2),mat4.scale(f,f,[k[1],128/b.width,1]),c.bind(),c.a(f),c.color.apply(c,[b.F[0],
b.F[1],b.F[2],.5]),d.da.bind(c,null),d.da.v(),c.color.apply(c,b.F),d.ea.bind(c,null),d.ea.v(),b.disable(b.SCISSOR_TEST));n.showColormapHistogram&&m[2].C&&(d=m[2],b.enable(b.SCISSOR_TEST),b.scissor(0,e?b.height-g.y-g.height:g.y,b.width,g.height),c.bind(),h.bind(c,null),mat4.identity(f),!0===e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[2*(g.x+g.width+10+.5+64)/b.width-1,2*(g.y+.5)/b.height-1,0]),mat4.rotateZ(f,f,Math.PI/2),mat4.scale(f,f,[2*g.height/b.height,1,1]),c.a(f),h.v(),mat4.identity(f),!0===
e&&mat4.scale(f,f,[1,-1,1]),mat4.translate(f,f,[2*(g.x+g.width+10+.5)/b.width-1,l[2]+1/b.height,0]),mat4.rotateZ(f,f,Math.PI/2),mat4.scale(f,f,[k[2],-128/b.width,1]),c.bind(),c.a(f),c.color.apply(c,[b.F[0],b.F[1],b.F[2],.5]),d.da.bind(c,null),d.da.v(),c.color.apply(c,b.F),d.ea.bind(c,null),d.ea.v(),b.disable(b.SCISSOR_TEST))};this.B=function(b){k=b;d()};this.j=function(b){n=b;d()};this.c=function(b){p=b;d()};this.o=function(){}};var Hb=!1,Ib=!1,U=4;
qa("GlobalView",function(b,d){function e(b){pa=!1;"boolean"!==typeof b&&(b=!1);g.clear(g.COLOR_BUFFER_BIT);q.clear();if(!(0>=E.width||0>=E.height)){g.enable(g.SCISSOR_TEST);g.scissor(E.x,b?g.height-E.y-E.height:E.y,E.width,E.height);null!==C&&(C.animate()&&m.u(),w.P(b,C,z[0],z[1]),x.P(b,C,H.ha(),Ha),r.P(b,C));g.disable(g.SCISSOR_TEST);null!==C&&B.P(b,C,E);G.P(b,E);H.P(b,E);null===F||0==F.width&&0==F.height||g.cb(F.x,F.y,F.width,F.height);null!==P&&(g.gb(P),g.bb(P));b=performance.now();u=b-t;t=b;if(Ib){++v;
if(1E4<t-A||1E3<v)D=1E3*v/(t-A),A=t,v=0;null!==D?g.aa(D.toFixed(5)+" FPS",l.width-8,8,"topright"):g.aa("approx. "+Math.floor((1==v?1E4:1E3*v)/(t-A))+" FPS",l.width-8,8,"topright")}Hb&&m.u()}}function c(){function b(){f=!1;for(var b=0;b<U;++b)c[b]=y.f[z[b]].offset,e[b]=y.f[z[b]].scale,d[b]=0;c[0]*=2*E.width/g.width;c[0]+=2*E.x/g.width-1;c[1]*=2*E.height/g.height;c[1]+=2*E.y/g.height-1;e[0]*=2*E.width/g.width;e[1]*=2*E.height/g.height;d[0]*=2*E.width/g.width;d[1]*=2*E.height/g.height}var c=new Float32Array(U),
e=new Float32Array(U),d=new Float32Array(U),f=!1;this.j=function(b,c,e){y.f[b].scale=e-c;y.f[b].offset=-1E-5<y.f[b].scale&&1E-5>y.f[b].scale?.5-.5*(c+e)*(y.f[b].scale=.5):-c*(y.f[b].scale=1/y.f[b].scale);f=!0;b===z[0]&&p(0,z[0]);b===z[1]&&p(1,z[1]);b===z[2]&&n(z[2]);b!==z[0]&&b!==z[1]&&b!==z[2]||m.u()};this.translate=function(b,c){y.f[b].offset+=c*y.f[b].scale;f=!0;b===z[0]&&p(0,z[0],!1);b===z[1]&&p(1,z[1],!1);b===z[2]&&n(z[2],!1);b!==z[0]&&b!==z[1]&&b!==z[2]||m.u()};this.scale=function(b,c){y.f[b].scale*=
c;f=!0;b===z[0]&&p(0,z[0]);b===z[1]&&p(1,z[1]);b===z[2]&&n(z[2]);b!==z[0]&&b!==z[1]&&b!==z[2]||m.u()};this.S=function(){f=!0};this.ha=function(){return y.f[z[3]].offset};this.a=function(b){return y.f[z[b]].scale};this.B=function(b){return y.f[z[b]].g};this.o=function(b){return y.f[z[b]].h};this.D=function(b){return(0-y.f[z[b]].offset)/y.f[z[b]].scale};this.w=function(b){return(1-y.f[z[b]].offset)/y.f[z[b]].scale};this.Ga=function(){!0===f&&b();return c};this.Ia=function(){!0===f&&b();return e};this.Ua=
function(){!0===f&&b();return d};this.c=function(g,d){!0===f&&(f=!1,b());for(var h=0,k=Math.min(d.length,g.length,U);h<k;++h)g[h]=(d[h]-c[h])/e[h]};this.L=function(c,g){!0===f&&(f=!1,b());for(var d=0,h=Math.min(g.length,c.length,U);d<h;++d)c[d]=g[d]/e[d]};this.Z=function(d,g){!0===f&&(f=!1,b());for(var h=0,k=Math.min(g.length,d.length,U);h<k;++h)d[h]=c[h]+g[h]*e[h]};this.Ba=function(c,d){!0===f&&(f=!1,b());for(var g=0,h=Math.min(d.length,c.length,U);g<h;++g)c[g]=d[g]*e[g]};this.R=function(g,d){!0===
f&&(f=!1,b());for(var h=0,k=g.length;h<k;++h)g[h]=c[h]+d[z[h]]*e[h]};this.Ya=function(c,e){!0===f&&(f=!1,b());for(var g=0,d=c.length;g<d;++g)c[g]=e[z[g]]*y.f[z[g]].scale};this.animate=function(){for(var b=f=!1,h=R.map(function(b){return b.origin}),k=z,l=0;l<U;++l){var T=y.f[k[l]].scale,n=y.f[k[l]].offset;if(R[l].origin==z[l])e[l]=T,c[l]=n,d[l]=0;else{var b=y.f[h[l]].scale,m=R[l].qa;c[l]=m*n+(1-m)*y.f[h[l]].offset;m*=Math.PI/2;e[l]=Math.sin(m)*T;d[l]=Math.cos(m)*b;R[l].qa+=.001*u;1<=R[l].qa&&(R[l].origin=
z[l]);b=!0}}c[0]*=2*E.width/g.width;c[0]+=2*E.x/g.width-1;c[1]*=2*E.height/g.height;c[1]+=2*E.y/g.height-1;e[0]*=2*E.width/g.width;e[1]*=2*E.height/g.height;d[0]*=2*E.width/g.width;d[1]*=2*E.height/g.height;return b}}function h(b){if(L(b)&&4===b.length)var c=b.map(function(c,e){return Math.floor(N(c)?Number.parseFloat(c)*(c.endsWith("%")?(e%2?l.height:l.width)/100:1):b[e])});else if(ra(b)||N(b))c=Array.create(4,function(c){return Math.floor(N(b)?Number.parseFloat(b)*(b.endsWith("%")?(c%2?l.height:
l.width)/100:1):b)});var e={x:c[3],y:c[2],width:l.width-c[3]-c[1],height:l.height-c[0]-c[2]};e.x!=E.x||e.y!=E.y||e.width!=E.width||e.height!=E.height?S.forEach(function(b){return b.o(E=e)}):E=e}function k(b,c){Ib=Hb=I.enableContinuousRendering;I.enableTransparency?g.enable(g.BLEND):g.disable(g.BLEND);H.a=I.showColormap;w.a=I.showPointDensity;w.w=I.showPointClusters;w.D(I.pointClusterThreshold);I.padding&&h(I.padding);S.forEach(function(b){return b.j(I,c)});null!==y&&(D=null,A=t,v=0,b&&this.u())}function p(b,
c,e){y.f[c].values?G.w(b,C.D(b),C.w(b),y.f[c].values):G.D(b,C.D(b),C.w(b),e);G.L(b,y.f[c].label)}function n(b,c){y.f[b].values?H.w(C.D(2),C.w(2),y.f[b].values):H.D(C.D(2),C.w(2),c);H.L(y.f[b].label)}for(var m=this,l=null,f=0;f<b.children.length;++f)if(b.children[f]instanceof HTMLCanvasElement&&b.children[f].jb){l=b.children[f];break}null===l&&(l=document.createElement("canvas"),l.style.position="static",l.style.left=l.style.top="0px",l.style.width=l.style.height="100%",l.style.backgroundColor="transparent",
l.jb=!0,b.appendChild(l));this.invalidate=this.u=function(){};var g=l.getContext("webgl");if(g){g.getExtension("OES_element_index_uint")||console.warn("GlobalView warning: Unsupported WebGL extension: OES_element_index_uint");g.ext=g.getExtension("ANGLE_instanced_arrays");g.ext||console.warn("GlobalView warning: Unsupported WebGL extension: ANGLE_instanced_arrays");f=window.getComputedStyle(b);g.pa="transparent"==f.backgroundColor?[0,0,0,0]:Ca(f.backgroundColor);g.F=Ca(g.Ea=f.color);this.updateColorSchema=
function(){var c=window.getComputedStyle(b);g.pa="transparent"==c.backgroundColor?[0,0,0,0]:Ca(c.backgroundColor);g.F=Ca(g.Ea=c.color);g.clearColor.apply(g,g.pa);G.S();H.S();this.u()};var q=new pb(g,l);q.c(f.fontSize+" "+f.fontFamily);this.updateFont=function(){var c=window.getComputedStyle(b);q.c(c.fontSize+" "+c.fontFamily);this.u()};var t=performance.now(),u=.1,D=null,A=t,v=0,x=new Bb(g,this),r=new Eb(g,this),w=new Fb(g,this),B=new Gb(g),G=new Ab(g,this),H=new vb(g,this),S=[x,r,w,B,G,H],y=null,
z=Array.create(U,-1),R=Array.create(U,function(){return{target:null,qa:0}});this.points=x.a;x.D=x.w([0,255,0,255],1);this.createPointSet=x.w;this.removePointSet=x.L;var F=null,P=null,Ha=null,pa=!1;this.invalidate=this.u=function(){!1===pa&&null===M&&(pa=!0,window.a(e))};var Ia=null,wa=function(){var b=l.getBoundingClientRect(),c=b.right-b.left,b=b.bottom-b.top;M||c===g.width&&b===g.height||(g.viewport(0,0,g.width=l.width=c,g.height=l.height=b),q.a(),I.padding&&h(I.padding),!1===pa&&null===M&&(pa=
!0,window.a(e)),null!==Ia&&clearTimeout(Ia),Ia=setTimeout(wa,100))},C=null,E={x:0,y:0,width:0,height:0};this.Ha=function(){return E};this.zoomFit=this.ya=function(){for(var b=y.f.length,c=0;c<b;++c)C.j(c,y.f[c].g,y.f[c].h)};this.zoomFit2D=function(){var b=z[0],c=z[1];C.j(b,y.f[b].g,y.f[b].h);C.j(c,y.f[c].g,y.f[c].h)};this.zoomRect=function(b){var c=z[1];C.j(z[0],b.l,b.r);C.j(c,b.t,b.b)};var W={padding:{description:"The space around the drawing area in the form [top, right, bottom, left]. X-axis, y-axis and colormap are drawn within padding space.",
default:[50,60,50,50],valid:function(b){return ra(b)||N(b)||L(b)&&4===b.length},H:!0,G:!1},showColormap:{description:"When enabled, shows a colormap to the right of the plot.",default:!0,valid:[!0,!1],H:!0,G:!1},enableScrolling:{description:"When enabled, scrolling above the plot zooms in or out of the data.",default:!0,valid:[!0,!1],H:!1,G:!1},enableThumbnailDragging:{description:"When enabled, thumbnails can be dragged with the mouse.",default:!0,valid:[!0,!1],H:!1,G:!1},enableContinuousRendering:{description:"When enabled, the canvas is continuously rerendered at up to 60 frames per second. Keep this setting disabled to save processing resources.",
default:!1,valid:[!0,!1],H:!0,G:!1},enableTransparency:{description:"Enables/disables blending in WebGL. Whenever using any kind of transparency, this setting should be kept enabled.",default:!0,valid:[!0,!1],H:!0,G:!1},showPointDensity:{description:"When enabled, draws an image into the background, that shows density of points. (can be combined with 'showPointClusters')",default:!1,valid:[!0,!1],H:!0,G:!1},showPointClusters:{description:"When enabled, draws an image into the background, that shows colored clusters of points. (can be combined with 'showPointDensity')",
default:!1,valid:[!0,!1],H:!0,G:!1},pointClusterThreshold:{description:"Controls the realtive threshold between clusters and outliers when showing clusters (see 'showPointClusters')",default:(new $a).threshold,valid:function(b){return 0<b},H:!1,G:!1},showXAxisHistogram:{description:"When enabled, shows a histogram between the x-axis and the plot.",default:!1,valid:[!0,!1],H:!0,G:!1},showYAxisHistogram:{description:"When enabled, shows a histogram between the y-axis and the plot.",default:!1,valid:[!0,
!1],H:!0,G:!1},showColormapHistogram:{description:"When enabled, shows a histogram between the colormap and the plot.",default:!1,valid:[!0,!1],H:!0,G:!1},numHistogramBins:{description:"Controls the number of bins within each histogram in the scatterplot.",default:50,valid:function(b){return 1<=b},H:!0,G:!1},histogramHeight:{description:"Controls the height of each histogram in the scatterplot (in pixels).",default:64,valid:function(b){return 0<=b},H:!0,G:!1},pointShape:{description:"Controls the shape of data points in the scatterplot.",
default:"Circle",valid:"Rectangle Circle Cross Diamond Gaussian Custom".split(" "),H:!0,G:!0},customPointShape:{description:"When 'pointShape' is set to 'Custom', this defines a GLSL function given vec2 p, that returns opacity in the range [0.0 ... 1.0] at location p.",default:"{ return 1.0; }",valid:function(b){var c=g;var e=c.createShader(c.VERTEX_SHADER);c.shaderSource(e,"void main() {} float opacityMap(in vec2 p) "+b);c.compileShader(e);c.getShaderParameter(e,c.COMPILE_STATUS)?(c.deleteShader(e),
c=!0):(b=c.getShaderInfoLog(e),c.deleteShader(e),c=b);return c},H:!0,G:!0},pointSize:{description:"Controls the diameter of data points in the scatterplot (in pixels).",default:6,valid:function(b){return 0<=b},H:!0,G:!1},pointOpacity:{description:"Controls the visibility of data points in the scatterplot between 0 (invisible) and 1 (fully opaque).",default:1,valid:function(b){return 0<=b&&1>=b},H:!0,G:!1},pointColor:{description:"Controls the color of data points in the scatterplot. Valid values are an array of bytes in RGBA order or a colormap name.",
default:"exhue",valid:function(b){return zb(b)},H:!0,G:!1},thumbnailSize:{description:"Controls the width/height of thumbnails in the scatterplot (in pixels).",default:64,valid:function(b){return 0<b},H:!0,G:!1},thumbnailBorderColor:{description:"Controls the color of thumbnail borders in the scatterplot. Valid values are an array of bytes in RGBA order, a color name or 'null'. If set to 'null', the CSS foreground color will be used.",default:null,valid:function(b){return null===b||xb(b)},H:!0,G:!1},
thumbnailLineColor:{description:"Controls the color of thumbnail line in the scatterplot. Valid values are an array of bytes in RGBA order, a color name or 'null'. If set to 'null', the CSS foreground color will be used.",default:null,valid:function(b){return null===b||xb(b)},H:!0,G:!1},thumbnailLabelColor:{description:"Controls the color of thumbnail labels in the scatterplot. Valid values are an array of bytes in RGBA order, a color name or 'null'. If set to 'null', the CSS foreground color will be used.",
default:null,valid:function(b){return null===b||xb(b)},H:!0,G:!1},labelThumbnails:{description:"When enabled, links thumbnails to points using unique labels instead of lines.",default:!1,valid:[!0,!1],H:!0,G:!1}},I={},Ja=[];this.setOption=this.a=function(b,c){if(W.hasOwnProperty(b)){var e=W[b],g;L(e.valid)&&-1===e.valid.indexOf(c)||K(e.valid)&&!0!==(g=e.valid(c))?(console.warn("GlobalView warning: Invalid value for option "+b+": "+c),N(g)&&console.warn("                    "+g)):(I[b]=c,k.call(this,
e.H,e.G))}else console.warn("GlobalView warning: Unsupported option: "+b)};this.setOptions=this.c=function(b){var c=!1,e=!1,g;for(g in b)if(b.hasOwnProperty(g))if(W.hasOwnProperty(g)){var d=W[g],f=b[g],h;L(d.valid)&&-1===d.valid.indexOf(f)||K(d.valid)&&!0!==(h=d.valid(f))?(console.warn("GlobalView warning: Invalid value for option "+g+": "+f),N(h)&&console.warn("                    "+h)):(I[g]=f,c=c||d.G,e=e||d.H)}else console.warn("GlobalView warning: Unsupported option: "+g);k.call(this,e,c)};this.setDefaultOption=
function(b){W.hasOwnProperty(b)?this.a(b,W[b].default):console.warn("GlobalView warning: Unsupported option: "+b)};this.setDefaultOptions=this.B=function(){var b={},c;for(c in W)W.hasOwnProperty(c)&&(b[c]=W[c].default);this.c(b)};this.validateOption=function(b,c){if(!W.hasOwnProperty(b))return"Unsupported option: "+b;var e=W[b],g;return L(e.valid)&&-1===e.valid.indexOf(c)||K(e.valid)&&!0!==(g=e.valid(c))?"Invalid value for option "+b+": "+c+(N(g)?"\n    "+g:""):!0};this.validateOptions=function(b){var c=
[],e;for(e in b)if(b.hasOwnProperty(e))if(W.hasOwnProperty(e)){var g=W[e],d=b[e],f;(L(g.valid)&&-1===g.valid.indexOf(d)||K(g.valid)&&!0!==(f=g.valid(d)))&&c.push("Invalid value for option "+e+": "+d+(N(f)?"\n    "+f:""))}else c.push("Unsupported option: "+e);return c.length?c.join("\n"):!0};this.getOption=function(b){return I[b]};this.getOptions=function(){return JSON.parse(JSON.stringify(I))};this.pushOptions=function(){Ja.push(I)};this.popOptions=function(){Ja.length&&this.c(Ja.pop())};this.load=
function(b,e,g,d,f){y=null;z=Array.create(U,-1);r.w();y=b;R[0].origin=z[0]=e;R[1].origin=z[1]=g;R[2].origin=z[2]=d;R[3].origin=z[3]=f;C=new c;this.ya();S.forEach(function(b){return b.B(y,I)});S.forEach(function(b){return b.c(z,R,I)});D=null;A=t;v=0;this.u()};this.setActiveColumn=function(b,c){Hb||(u=0,t=performance.now());R[b].origin=z[b];R[b].qa=0;z[b]=c;C.S();S.forEach(function(b){return b.c(z,R,I)});2>b?p(b,z[b]):n(z[2]);3>b&&this.u()};this.getActiveColumn=this.Ta=function(b){return 0<=b&&b<z.length?
z[b]:-1};this.getCharacteristicPoints=function(b,c,e){if(y){var g=z[0],d=z[1];y.ga(g,d,void 0,void 0,function(f){if(d<g){var h=g;g=d;d=h}f=hb(y,g,d,f,b,c);e(f)})}};this.clearThumbnails=function(){y&&y.o(function(b){if(b.V&&b.V.data){var c=0;b=b.V.data;for(var e=b.length;c<e;++c)b[c]=0}});r.w();this.u()};this.showData2D=function(){r.w();var b=z[0],c=z[1];y.ga(b,c,void 0,void 0,function(e){if(c<b){var d=b;b=c;c=d}e.V||(e.V={});x.D.assign(hb(y,b,c,e,16,.3));y.a&&x.D.forEach(function(d){if(y.a[d]){var f=
y.f.map(function(b){return b.m(d)}),h=f.slice(0),l=ib(y,b,c,d,e,e.V,.6*I.thumbnailSize/g.width,.6*(I.thumbnailSize+V)/g.height);h[b]=l[0];h[c]=l[1];l=y.f.map(function(b){return I.thumbnailSize*(b.h-b.g)});r.a(y.a[d],d,f,h,l)}})})};this.showImage_lowDensity=this.o=function(b){if(y.a&&y.a[b]){var c=z[0],e=z[1];y.ga(c,e,void 0,void 0,function(d){var f=.6*I.thumbnailSize/g.width,h=(.6*I.thumbnailSize+V)/g.height;if(e<c){var l=c;c=e;e=l;l=f;f=h;h=l}var l=y.f.map(function(c){return c.m(b)});if(J(d.data))var k=
kb(y,b,d,.6*I.thumbnailSize/Math.min(g.width,g.height));else k=l.slice(0),d.V||(d.V={}),(d=ib(y,c,e,b,d,d.V,f,h))?(k[c]=d[0],k[e]=d[1]):(d=[1.1*I.thumbnailSize/g.width,1.1*I.thumbnailSize/g.height],C.L(d,d),k[c]+=d[0],k[e]+=d[1]);d=y.f.map(function(b){return I.thumbnailSize*(b.h-b.g)});r.a(y.a[b],b,l,k,d)})}};this.showImages_lowDensity=this.L=function(b){if(y.a){var c=z[0],e=z[1];y.ga(c,e,void 0,void 0,function(d){var f=.6*I.thumbnailSize/g.width,h=(.6*I.thumbnailSize+V)/g.height;if(e<c){var l=c;
c=e;e=l;l=f;f=h;h=l}d.V||(d.V={});jb(y,c,e,b,d,d.V,f,h)})}b.forEach(function(b){return m.o(b)});r.S(C)};this.showImage_none=this.w=function(b){var c=y.f.map(function(c){return c.m(b)});r.a(y.a[b],b,c)};this.showImages_none=this.S=function(b){b.forEach(function(b){var c=y.f.map(function(c){return c.m(b)});r.a(y.a[b],b,c)})};this.showImage_adjacent=this.j=function(b){var c=y.f.map(function(c){return c.m(b)}),e=y.f.map(function(b){return I.thumbnailSize*(b.h-b.g)});r.a(y.a[b],b,c,c,e,"bottomleft")};
this.showImages_adjacent=this.D=function(b){b.forEach(function(b){return m.j(b)})};this.showImages_project=this.ha=function(b){if(y.a){var c=z[0],e=z[1],d=C.Ga(),g=C.Ia(),f=[0,0];b.forEach(function(b){f[0]+=y.f[c].m(b);f[1]+=y.f[e].m(b)});f[0]*=g[0]/b.length;f[1]*=g[1]/b.length;var h=[0,0,0];b.forEach(function(b){var d=y.f[c].m(b)*g[0]-f[0];b=y.f[e].m(b)*g[1]-f[1];h[0]+=d*d;h[1]+=d*b;h[2]+=b*b});h[0]/=b.length;h[1]/=b.length;h[2]/=b.length;var l=Math.sqrt((h[0]-h[2])*(h[0]-h[2])+4*h[1]*h[1])/2,k=
[-h[1],h[0]-Math.min((h[0]+h[2])/2+l,(h[0]+h[2])/2-l)],l=Math.sqrt(k[0]*k[0]+k[1]*k[1]);k[0]/=l;k[1]/=l;var m=y.f.map(function(b){return I.thumbnailSize*(b.h-b.g)}),l=1+V/I.thumbnailSize,n=1+(V+2*Cb)/I.thumbnailSize,p=[C.B(0)-.6*m[c]/E.width,C.B(1)-.6*m[e]/E.height],q=[C.B(0)-.6*m[c]/E.width,C.o(1)+m[e]*l*.8/E.height],t=[C.o(0)+m[c]*n*.6/E.width,C.o(1)+m[e]*l*.8/E.height],u=[C.o(0)+m[c]*n*.6/E.width,C.B(1)-.6*m[e]/E.height];C.Z(p,p);C.Z(q,q);C.Z(t,t);C.Z(u,u);var v=function(b){b[0]=Math.max(0,Math.min(1,
(b[0]-q[0])/(u[0]-q[0])));b[1]=Math.max(0,Math.min(1,(b[1]-q[1])/(u[1]-q[1])));switch(ta([b[0],b[1],1-b[0],1-b[1]])){default:return 1-b[1];case 1:return 1+b[0];case 2:return 2+b[1];case 3:return 4-b[0]}},x=function(b){b=(b+4)%4;var c=Math.floor(b);switch(c){case 0:var e=[0,c+1-b];break;case 1:e=[b-c,0];break;case 2:e=[1,b-c];break;case 3:e=[c+1-b,1]}e[0]=e[0]*(u[0]-q[0])+q[0];e[1]=e[1]*(u[1]-q[1])+q[1];return e},w=[],T,A=y.f[z[0]],D=y.f[z[1]];b.forEach(function(b){y.a[b]&&(b=[A.m(b),D.m(b)],C.Z(b,
b),0<vec2.dot([b[0]-d[0]-f[0],b[1]-d[1]-f[1]],k)?(T=mb(b,k,p,q))||(T=mb(b,k,q,t)):(T=mb(b,k,p,u))||(T=mb(b,k,u,t)),T&&w.push(v(T)))});var l=function(b,c){for(var e=[],d=1;d<b.length;++d)for(var g=0;g<d;++g)Math.abs(b[g]-b[d])<c&&e.push([g,d]);return e},B=w,F=Math.min(.15,4/w.length),G=Array.create(B.length,function(b){return b});G.sort(function(b,c){return w[b]<w[c]?-1:w[b]>w[c]?1:0});for(var n=l(B,F),H=0;1E4>H&&0!==n.length;++H)n.forEach(function(b){var c=b[0];b=b[1];var e=F+1E-4;0<e-Math.abs(B[c]-
B[b])&&(e=.5*(G[c]>G[b]?e-(B[c]-B[b]):B[b]-B[c]-e),B[c]+=e,B[b]-=e)}),n=l(B,F);l=Array.create(B.length,function(b){return b});l.sort(function(b,c){return B[b]<B[c]?-1:B[b]>B[c]?1:0});n=Array(B.length);for(H=0;H<B.length;++H)n[G[H]]=B[l[H]];var w=n,M=0;b.forEach(function(b){if(y.a[b]){var d=y.f.map(function(c){return c.m(b)}),g=d.slice(0);T=x(w[M++]);C.c(T,T);g[c]=T[0];g[e]=T[1];r.a(y.a[b],b,d,g,m)}});r.S(C)}};this.showImage=function(b,c){switch(c){case "none":return this.w(b);case "adjacent":return this.j(b);
case "lowDensity":return this.o(b);case "project":return console.warn("GlobalView warning: Can't place a single image using the 'project'-strategy"),!1;default:return console.warn("GlobalView warning: Unknown image placement strategy: "+c),!1}};this.showImages=function(b,c){switch(c){case "none":return this.S(b);case "adjacent":return this.D(b);case "lowDensity":return this.L(b);case "project":return this.ha(b);default:return console.warn("GlobalView warning: Unknown image placement strategy: "+c),
!1}};this.highlightImage=function(b){var c=r.D();if(ra(b))for(var e=0;e<c.length;++e)c[e].highlighted=e===b;else for(e=0;e<c.length;++e)c[e].highlighted=c[e]===b;this.u()};this.getImages=r.D;var Y=-1,ca=null,fa=null,xa,ya,za,ha=null,X=null,ia=null,Z=[];this.onMouseDown=function(b){switch(b.button){case 0:b.pointSelection=!0;b.pointDragging=!0;Aa?b.viewDragging=!0:b.lassoSelection=!0;break;case 1:b.viewDragging=!0}};this.onThumbnailSelectionChanged=this.onLassoSelection=this.onSelectionChanged=this.onMouseOverAxisLabel=
this.onMouseOverDatapoint=null;var Aa=!1,Ka=!1,fb=-1==navigator.appVersion.indexOf("Mac")?17:224;Na(function(b){b.keyCode===fb?Aa=!0:16===b.keyCode&&(Ka=!0)});Oa(function(b){b.which===fb?Aa=!1:16===b.keyCode&&(Ka=!1)});l.oncontextmenu=function(){return!1};l.onmousedown=function(b){if(null!==C&&null===M){var c=l.getBoundingClientRect(),e=new Float32Array([b.clientX-c.left,b.clientY-c.top,b.clientY-c.top]);this.onMouseDown(b);if(b.viewDragging){if(e[0]>E.x+E.width?(xa=ya=!1,za=H.a):(xa=e[0]>=E.x,ya=
e[1]<=E.y+E.height,za=!1),e[0]=2*e[0]/c.width-1,e[1]=1-2*e[1]/c.height,e[2]=1-(e[2]-E.y)/E.height,xa||ya||za)fa=e}else{e[0]=2*e[0]/c.width-1;e[1]=1-2*e[1]/c.height;var d=r.L(C,e);if(!(Ka||Aa||0===Z.length||null!==d&&-1!==Z.indexOf(d))&&(Z.forEach(function(b){return b.highlighted=!1}),Z=[],this.u(),null!==this.onThumbnailSelectionChanged))this.onThumbnailSelectionChanged(y,[]);if(null!==d){d.highlighted=!0;-1===Z.indexOf(d)&&Z.push(d);I.enableThumbnailDragging&&(ia=e);this.u();if(b.pointSelection&&
null!==this.onSelectionChanged)this.onSelectionChanged(y,[]);if(null!==this.onThumbnailSelectionChanged)this.onThumbnailSelectionChanged(y,Z)}else{C.c(e,e);var g=Number.MAX_VALUE,f=-1,h=C.a(0)*C.a(0),k=C.a(1)*C.a(1),m=y.f[z[0]],n=y.f[z[1]];x.a.forEach(function(b){q=h*Math.pow(e[0]-m.m(b),2)+k*Math.pow(e[1]-n.m(b),2);q<g&&(g=q,f=b)});d=new Float32Array([m.m(f),n.m(f)]);C.Z(d,d);d[0]=(.5+.5*d[0])*c.width;d[1]=(.5-.5*d[1])*c.height;var q=Math.pow(b.clientX-c.left-d[0],2)+Math.pow(b.clientY-c.top-d[1],
2);if(q>Math.pow(I.pointSize/2,2)){if((b.lassoSelection||b.polygonLassoSelection)&&null!==this.onLassoSelection&&(b.polygonLassoSelection?P=[]:F={x:b.clientX-c.left,y:b.clientY-c.top,width:0,height:0}),b.pointSelection&&null!==this.onSelectionChanged)this.onSelectionChanged(y,[])}else if(b.pointDragging&&(ca=[d[0],d[1],f]),b.pointSelection&&null!==this.onSelectionChanged)this.onSelectionChanged(y,[f])}}}}.bind(this);var gb;La(gb=function(b){if(null!==C&&null===M&&(b.target===l||null!==ca||null!==
fa||null!==ia||null!==F||null!==P)){var c=l.getBoundingClientRect(),e=new Float32Array([b.clientX-c.left,b.clientY-c.top,b.clientY-c.top]);if(null!==P)P.push(e),this.u();else if(null!==F)F.width=e[0]-F.x,F.height=e[1]-F.y,this.u();else if(ca)b=1/(y.f[z[3]].m(ca[2])*C.a(3))+C.ha(),Ha=[b*(e[0]-ca[0]),b*(e[1]-ca[1])],this.u();else{if(this.onMouseOverAxisLabel){var d=G.ya(E,e);if(d!==ha)if(null!==(ha=d))this.onMouseOverAxisLabel(y.f[z[ha]],G.ha(E,ha));else this.onMouseOverAxisLabel(null,null)}e[0]=2*
e[0]/c.width-1;e[1]=1-2*e[1]/c.height;e[2]=1-(e[2]-E.y)/E.height;var d=z[0],g=z[1];if(fa)b=z[2],c=vec3.create(),C.L(c,vec3.subtract(c,e,fa)),xa&&C.translate(d,c[0]),ya&&C.translate(g,c[1]),za&&C.translate(b,c[2]),fa=e;else if(ia){var f=vec2.create();C.L(f,vec2.subtract(f,e,ia));Z.forEach(function(b){b.A[z[0]]+=f[0];b.A[z[1]]+=f[1]});ia=e;this.u()}else if(null!=X&&-1===Z.indexOf(X)&&(X.highlighted=!1,this.u(),X=null),X=r.L(C,e),null!=X){if(-1===Z.indexOf(X)&&(X.highlighted=!0,this.u()),-1!==Y&&(Y=
-1,null!==this.onMouseOverDatapoint))this.onMouseOverDatapoint(y,Y)}else{C.c(e,e);var h=Number.MAX_VALUE,k=-1,m=C.a(0)*C.a(0),n=C.a(1)*C.a(1),q=y.f[d],p=y.f[g];x.a.forEach(function(b){u=m*Math.pow(e[0]-q.m(b),2)+n*Math.pow(e[1]-p.m(b),2);u<h&&(h=u,k=b)});d=new Float32Array([q.m(k),p.m(k)]);C.Z(d,d);d[0]=(.5+.5*d[0])*c.width;d[1]=(.5-.5*d[1])*c.height;var u=Math.pow(b.clientX-c.left-d[0],2)+Math.pow(b.clientY-c.top-d[1],2);if(u>Math.pow(I.pointSize/2,2)){if(-1!==Y&&(Y=-1,null!==this.onMouseOverDatapoint))this.onMouseOverDatapoint(y,
Y)}else if(Y!==k&&(Y=k,null!==this.onMouseOverDatapoint))this.onMouseOverDatapoint(y,Y)}}}}.bind(this));Ma(function(b){var c,e;if(null!==C&&null===M&&(b.target===l||null!==ca||null!==fa||null!==F)){var d=!1;null!==ca&&(ca=Ha=null,d=!0);fa=ia=null;if(null!==P){if(null!==this.onSelectionChanged&&3<=P.length){for(var g=0;g<P.length;++g)d=P[g],d[0]=2*d[0]/l.width-1,d[1]=1-2*d[1]/l.height,C.c(d,d),P[g]=d;P.push(P[0]);var f=[];var h=y.f[z[0]];var k=y.f[z[1]];x.a.forEach(function(b){e=h.m(b);c=k.m(b);ob([e,
c],P)&&f.push(b)});this.onLassoSelection(y,f,P)}P=null;d=!0}null!==F&&(null!==this.onSelectionChanged&&F.width&&F.height&&(0>F.width&&(F.x+=F.width,F.width=-F.width),0>F.height&&(F.y+=F.height,F.height=-F.height),F.Ka=2*F.x/l.width-1,F.r=2*(F.x+F.width)/l.width-1,F.t=1-2*(F.y+F.height)/l.height,F.la=1-2*F.y/l.height,d=new Float32Array([F.Ka,F.t]),C.c(d,d),F.Ka=d[0],F.t=d[1],d=new Float32Array([F.r,F.la]),C.c(d,d),F.r=d[0],F.la=d[1],f=[],h=y.f[z[0]],k=y.f[z[1]],x.a.forEach(function(b){e=h.m(b);c=k.m(b);
e>=F.Ka&&e<F.r&&c>=F.t&&c<F.la&&f.push(b)}),this.onLassoSelection(y,f,F)),F=null,d=!0);d&&(this.u(),gb(b))}}.bind(this));l.onmouseleave=function(){null!=X&&-1===Z.indexOf(X)&&(X.highlighted=!1,this.u(),X=null);this.onMouseOverAxisLabel&&null!==ha&&(this.onMouseOverAxisLabel(null,null),ha=null);if(null!==this.onMouseOverDatapoint&&-1!==Y)this.onMouseOverDatapoint(y,Y=-1)}.bind(this);Ga(function(b){if(b.target===l&&I.enableScrolling){var c=null==b.wheelDelta?b.detail:-b.wheelDelta/20;b.preventDefault();
var e=l.getBoundingClientRect();b=new Float32Array([b.clientX-e.left,b.clientY-e.top,b.clientY-e.top]);var d;if(b[0]>E.x+E.width){var g=d=!1;var f=!0}else g=b[0]>=E.x,d=b[1]<l.height-E.y,f=!1;b[0]=2*b[0]/e.width-1;b[1]=1-2*b[1]/e.height;b[2]=1-(b[2]-E.y)/E.height;var e=z[0],h=z[1],k=z[2];C.c(b,b);c=1-c/50;vec3.scaleAndAdd(b,b,b,-c);g&&(C.translate(e,b[0]),C.scale(e,c));d&&(C.translate(h,b[1]),C.scale(h,c));f&&(C.translate(k,b[2]),C.scale(k,c))}}.bind(this));this.ondragover=null;l.a=function(b){if(null!==
this.ondragover)this.ondragover(b)}.bind(this);this.ondrop=null;l.c=function(b){if(null!==this.ondrop)this.ondrop(b)}.bind(this);var M=null;this.enableOffscreenRendering=function(b,c){null===M&&(M={},g.width=l.width=b,g.height=l.height=c,q.o(b,c),M.tb=I.enableContinuousRendering,M.enableContinuousRendering&&this.a("enableContinuousRendering",!1),M.Xa=g.createTexture(),g.bindTexture(g.TEXTURE_2D,M.Xa),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,
g.LINEAR),M.Wa=g.createFramebuffer(),g.bindFramebuffer(g.FRAMEBUFFER,M.Wa),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,b,c,0,g.RGBA,g.UNSIGNED_BYTE,null),g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,M.Xa,0),g.bindTexture(g.TEXTURE_2D,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.oa=b,g.na=c,g.viewport(0,0,g.oa,g.na),I.padding&&h(I.padding))};this.disableOffscreenRendering=function(){null!==M&&(q.j(),g.bindFramebuffer(g.FRAMEBUFFER,null),g.deleteFramebuffer(M.Wa),g.oa=l.width,g.na=
l.height,g.viewport(0,0,g.oa,g.na),M.enableContinuousRendering&&this.a("enableContinuousRendering",!0),M=null,wa())};this.renderOffscreenBuffer=function(){e(!0);g.finish()};this.saveOffscreenBuffer=function(){var b=new Uint8Array(g.oa*g.na*4);g.readPixels(0,0,g.oa,g.na,g.RGBA,g.UNSIGNED_BYTE,b);var c=document.createElement("canvas");c.width=g.oa;c.height=g.na;var e=c.getContext("2d"),d=e.createImageData(c.width,c.height);d.data.set(b);e.putImageData(d,0,0);e.drawImage(q.B(),0,0);return c.toDataURL()};
g.disable(g.CULL_FACE);g.enable(g.BLEND);g.blendEquationSeparate(g.FUNC_ADD,g.FUNC_ADD);g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE);g.clearColor.apply(g,g.pa);window.addEventListener("resize",wa,!1);wa();this.B();this.c(d)}else alert("Error: WebGL not supported")});function Jb(b,d){var e=b.fa;if(ra(d)){var c=Math.round(d);this.getValue=this.m=function(d){return b.J[d*e+c]};this.Ja="c"+c;d=b.c[c];this.minimum=this.g=d.g;this.maximum=this.h=d.h;this.offset=-d.g*(this.scale=1/(d.h-d.g));this.values=this.values=d.values;this.label=this.label=d.label}else{var h=Array(16),k={n:O.float,PI:O.float,i:O.float};for(c=0;c<e;++c)k["c"+c]=O.float;var p={n:b.length,PI:Math.PI},n=Ta(d+";",k);if(N(n))console.error("GlobalView error: Error while parsing data vector formula '{0}'".format(d)),
console.error("                  "+n);else{this.Ja=d;this.getValue=this.m=function(c){p.i=c;for(var d=0;d<e;++d)p["c"+d]=b.J[c*e+d];c=-1;for(var d=0,f=p,l;++c<n.length;){l=p;switch(n[c]){case "float = float":f[h[--d]]=h[d-1];break;case "float += float":f[h[--d]]+=h[--d];break;case "float -= float":f[h[--d]]-=h[--d];break;case "float *= float":f[h[--d]]*=h[--d];break;case "float /= float":f[h[--d]]/=h[--d];break;case "float + float":h[d-2]+=h[--d];break;case "float * float":h[d-2]*=h[--d];break;case "float / float":h[d-
2]/=h[--d];break;case "sin(float)":h[d-1]=Math.sin(h[d-1]);break;case "cos(float)":h[d-1]=Math.cos(h[d-1]);break;case "tan(float)":h[d-1]=Math.tan(h[d-1]);break;case "asin(float)":h[d-1]=Math.asin(h[d-1]);break;case "acos(float)":h[d-1]=Math.acos(h[d-1]);break;case "atan(float)":h[d-1]=Math.atan(h[d-1]);break;case "min(float, float)":h[d-2]=Math.min(h[d-2],h[--d]);break;case "max(float, float)":h[d-2]=Math.max(h[d-2],h[--d]);break;case "vec3(float, float, float)":break;case "vec3 = vec3":f[h[--d]]=
[h[d-3],h[d-2],h[d-1]];break;case "vec3 + vec3":h[d-6]+=h[d-3];h[d-5]+=h[d-2];h[d-4]+=h[d-1];d-=3;break;case "vec3 * float":f=h[--d];h[d-3]*=f;h[d-2]*=f;h[d-1]*=f;break;case "@":h[d-1]=f[h[d-1]];break;case "@[]":for(var f=f[h[--d]],k=0;k<f.length;++k)h[d++]=f[k];break;case ".":l=f=f[h[--d]];break;case ";":d=0;break;default:h[d++]=n[c],l=f}f=l}return d?1===d?h[0]:h.slice(0,d):null};this.g=Number.MAX_VALUE;this.h=Number.MIN_VALUE;for(var k=0,m=b.length;k<m;++k){var l=this.m(k);this.g=Math.min(this.g,
l);this.h=Math.max(this.h,l)}this.minimum=this.g;this.maximum=this.h;this.scale=this.h-this.g;this.offset=-1E-5<this.scale&&1E-5>this.scale?.5-.5*(this.g+this.h)*(this.scale=.5):-this.g*(this.scale=1/this.scale);this.values=this.values=null;this.label=this.label=d}}}qa("DataVector",Jb);
function Kb(){this.length=this.length=this.fa=this.numColumns=0;this.c=this.columns=[];this.f=this.dataVectors=[];this.data=this.data=[];this.J=this.fdata=new Float32Array(0);this.a=this.imageFilenames=this.j=this.names=null;var b=[],d=[];this.isDensityMapReady=this.lb=function(e,c){if(e>=this.f.length||c>=this.f.length||e===c)return!1;if(c<e){var d=e;e=c;c=d}return b.length>e&&b[e].length>c&&b[e][c]&&(J(b[e][c].O)||b[e][c].K)};this.iterateDensityMaps=this.o=function(e){b.forEach(function(b){return b.forEach(function(b){return b&&
(J(b.O)||b.K)?e(b.K||b):null})})};this.requestDensityMap=this.ga=function(e,c,h,k,p){if(e>=this.f.length||c>=this.f.length)return console.warn("GlobalView warning: Requesting density map for dimensions {0}, {1} on a dataset with only {2} data vectors".format(e,c,this.f.length)),null;var n=K(p);if(e===c)return null;if(c<e){var m=e;e=c;c=m}for(;b.length<=e;)b.push([]);for(;b[e].length<=c;)b[e].push(null);m=b[e][c];h||(h=1024);m&&k&&m.options&&!Ya(k,m.options)&&(m=null);if(n){if(m)J(m.O)?p(m):!m.K||
k&&!Ya(m.K.options,k)?m.O.push(p):p(m.K);else{b[e][c]={O:[p],K:b[e][c]};var l=cb(this,e,c,h,h);h=new Parallel([ua(l),new Xa(k)],{fb:"eval.js"});h.require(Wa);h.require(db);h.spawn(function(b){return db.apply(null,b)}).then(function(f){f=new Wa(f);l=null;b[e][c].K=null;var g=b[e][c].O;b[e][c]=f;d.length>e&&d[e].length>c&&d[e][c]&&J(d[e][c].O)&&(d[e][c]=null);g.forEach(function(b){b(f)})})}return null}if(m)if(!m.K||k&&!Ya(m.K.options,k))for(;!J(b[e][c].O););else m=m.K;else l=cb(this,e,c,h,h),b[e][c]=
m=new Wa(db(l,new Xa(k))),l=null;K(p)&&p(m);return m};this.isClusterMapReady=this.kb=function(b,c){if(b>=this.f.length||c>=this.f.length||b===c)return!1;if(c<b){var e=b;b=c;c=e}return d.length>b&&d[b].length>c&&d[b][c]&&(J(d[b][c].O)||d[b][c].K)};this.requestClusterMap=this.Na=function(b,c,h,k){if(b>=this.f.length||c>=this.f.length)return console.warn("GlobalView warning: Requesting cluster map for dimensions {0}, {1} on a dataset with only {2} data vectors".format(b,c,this.f.length)),null;var e=
K(k);if(b!==c){if(c<b){var n=b;b=c;c=n}for(;d.length<=b;)d.push([]);for(;d[b].length<=c;)d[b].push(null);(n=d[b][c])&&h&&n.options&&!ab(h,n.options)&&(n=null);if(e)n?J(n.O)?k(n):!n.K||h&&!ab(n.K.options,h)?n.O.push(k):k(n.K):(d[b][c]={O:[k]},this.ga(b,c,void 0,void 0,function(e){e=new Parallel([ua(e),b,c,new $a(h)],{fb:"eval.js"});e.require(lb);e.require(Pa);e.require(Ra);e.spawn(function(b){return lb.apply(null,b)}).then(function(e){e=new Za(e);var f=d[b][c].O;d[b][c]=e;f.forEach(function(b){b(e)})})}));
else{if(n)if(!n.K||h&&!ab(n.K.options,h))for(;!J(n.O););else n=n.K;else e=this.ga(b,c,void 0,void 0),d[b][c]=e?n=new Za(lb(e,0,0,new $a(h))):n=null;K(k)&&k(n);return n}}};this.inflate=function(b,c){var d=this.length;b=Math.floor(b*d);var e=this.fa;if(!(isNaN(b)||b<=d)){for(var p=this.J,n=new Float32Array(b*e),m=this.data,l=Array(b*e),f=0,g=d*e;f<g;++f)n[f]=p[f];f=0;for(g=d*e;f<g;++f)l[f]=m[f];for(var q,g=1/c[0].size,f=d;f<b;++f){var p=c,m=p.length;q=Array(m+1);var t=Math.floor(Math.random()*m);do{var u=
p[t];var D=u.width,A=u.height,v=u.h;do{var x=Math.random()*D;var r=Math.random()*A;var w=Math.random()*v}while(u.data[Math.floor(r)*D+Math.floor(x)]<w);r=[x,r];q[t]=r[0];q[t+1]=r[1];u=r[0];for(w=t-1;0<=w&&!isNaN(u);--w){x=p[w];A=u;v=t-w;J(v)&&(v=Number.MAX_SAFE_INTEGER);var B=x.width,G=x.h,A=Math.floor(A)*x.height;do D=Math.random()*B,u=Math.random()*G;while(--v&&x.data[A+Math.floor(D)]<u);q[w]=u=x.data[A+Math.floor(D)]>=u?D:NaN}if(!isNaN(u))for(u=r[1],w=t+1;w<m&&!isNaN(u);++w){r=p[w];D=u;A=w-t;J(A)&&
(A=Number.MAX_SAFE_INTEGER);v=r.width;B=r.height;G=r.h;D=Math.floor(D);do u=Math.random()*B,x=Math.random()*G;while(--A&&r.data[Math.floor(u)*v+D]<x);q[w+1]=u=r.data[Math.floor(u)*v+D]>=x?u:NaN}}while(isNaN(u));m=q;for(t=0;t<e;++t)p=this.c[t],q=p.g+(p.h-p.g)*m[t]*g,p.values?(n[f*e+t]=q=Math.max(0,Math.min(p.values.length-1,Math.round(q))),l[f*e+t]=p.values[q]):(n[f*e+t]=q,l[f*e+t]=q)}this.fdata=this.J=n;this.data=this.data=l;if(null!==this.j){e=this.j;c=Array(b);f=0;for(g=d;f<g;++f)c[f]=e[f];e=0;
for(f=d;f<b;++f)c[f]="generated datapoint "+ ++e;this.names=this.j=c}if(null!==this.a){c=this.a;e=Array(b);f=0;for(g=d;f<g;++f)e[f]=c[f];for(f=d;f<b;++f)e[f]=c[f%d];this.imageFilenames=this.a=e}this.length=this.length=b}};this.save=this.save=function(b,c,d){var e=this.fa;if(!this.j||J(c)||J(d)){c=-1;var h=e}else h=e+1;for(var n=Array(this.length+1),m=Array(h),l=0,f=0;l<h;++l,++f)l===c?(m[l]=d,--f):m[l]=this.c[f].label;n[0]=m;for(d=0;d<this.length;++d){m=Array(h);for(f=l=0;l<h;++l,++f)l===c?(m[l]=
this.j[d],--f):m[l]=this.data[d*e+f];n[d+1]=m}c="data:text/csv;charset=utf-8,"+encodeURIComponent($.csv.fromArrays(n));Ea||document.body.appendChild(Ea=document.createElement("a"));Ea.href=c;Ea.download=b;Ea.click()}}qa("Dataset",Kb);
qa("RandomDataset",function(b,d,e){Kb.call(this);this.numColumns=this.fa=d;this.length=this.length=b;for(var c=0;c<d;++c)this.c.push({g:0,h:1,label:Lb(c,d)}),this.f.push(new Jb(this,c));b*=d;this.fdata=this.J=new Float32Array(b);for(c=0;c<b;++c)this.J[c]=Math.random();this.data=this.data=this.J;e&&e(this)});
var Mb={autoDetect:{description:"When true, tries to infer other options based on the structure of the dataset (slow).",default:!1,valid:[!0,!1]},hasHeader:{description:"When true, interprets the first row of the dataset as column labels.",default:!1,valid:[!0,!1]},nameColumn:{description:"Index of a column of the dataset that contains data point names.",default:null,valid:null},columnLabels:{description:"An array of column labels, or a function that takes the column index as input and returns the column label.",
default:null,valid:null},imageFilenames:{description:"An array of image URLs, or a function that takes a row of data and the row index as input and returns a URL to an image of the data point.",default:null,valid:null}};
qa("CsvDataset",function(b,d,e){function c(b){b=$.csv.toArrays(b);if(d.autoDetect){if(J(d.hasHeader)){d.hasHeader=!1;var c=b[0].every(function(b){return isNaN(parseFloat(b))}),g=b[1].some(function(b){return!isNaN(parseFloat(b))});c&&g&&(d.hasHeader=!0);console.log("Assuming hasHeader = "+d.hasHeader)}if(J(d.nameColumn)){d.nameColumn=null;for(var h=0;h<b[0].length;++h){var k={};if(b.every(function(b){return b.length>h&&isNaN(parseFloat(b[h]))&&!(b[h]in k)?k[b[h]]=!0:!1})){d.nameColumn=h;break}}console.log("Assuming nameColumn = "+
d.nameColumn)}}var c=b.length,l=b[0].length-(d.nameColumn?1:0),g=d.hasHeader?1:0;n.numColumns=n.fa=l;if(K(d.columnLabels)){var m=Array(c);for(var p=h=0;h<b[0].length;++h,++p)h==d.nameColumn?--p:m[p]=d.columnLabels(h)}else L(d.columnLabels)?d.columnLabels.length!==l?(console.warn("CsvDataset warning: Number of provided column labels ("+d.columnLabels.length+") differs from number of data columns in the dataset ("+l+")"),m=null):m=d.columnLabels:m=null;n.data=n.data=Array(l*c);n.fdata=n.J=new Float32Array(l*
c);for(var v,x,p=h=0;h<b[0].length;++h,++p)if(h==d.nameColumn)--p;else{var r=Number.MAX_VALUE,w=Number.MIN_VALUE,B=!0;v=g;for(x=0;v<b.length;++v,++x)if(1===b[v].length&&""===b[v][0])--x;else{var G=b[v][h];var H=parseFloat(G);if(isNaN(H)){B=!1;break}n.data[x*l+p]=G;n.J[x*l+p]=H;r=Math.min(r,H);w=Math.max(w,H)}var S=null;if(!B){S=[];k={};r=0;v=g;for(x=0;v<b.length;++v,++x)1===b[v].length&&""===b[v][0]?--x:(G=b[v][h],H=k[G],"undefined"===typeof H&&(S.push(G),H=k[G]=r++),H+=.5,n.data[x*l+p]=G,n.J[x*l+
p]=H);r=0;w=S.length}n.c.push({g:r,h:w,label:m?m[p]:d.hasHeader?b[0][h]:Lb(p,l),values:S});n.f.push(new Jb(n,p))}if(x!==c)if(x=c-x,c-=x,x*=l,n.data.splice(-x),Float32Array.prototype.splice)n.J.splice(-x);else if(Float32Array.prototype.slice)n.fdata=n.J=n.J.slice(0,-x);else{x=new Float32Array(l*c);v=0;for(G=x.length;v<G;++v)x[v]=n.J[v];n.fdata=n.J=x}n.length=n.length=c;if(d.nameColumn)for(G=n.names=n.j=Array(c),l=d.nameColumn,v=g,x=0;v<b.length;++v,++x)1===b[v].length&&""===b[v][0]?--x:G[x]=b[v][l];
else n.names=n.j=null;if(K(d.imageFilenames))for(n.imageFilenames=n.a=Array(c),v=g,x=0;v<b.length;++v,++x)1===b[v].length&&""===b[v][0]?--x:n.a[x]=d.imageFilenames(b[v],v);else L(d.imageFilenames)?d.imageFilenames.length!==c?(console.warn("CsvDataset warning: Number of provided image filenames ("+d.imageFilenames.length+") differs from number of data points ("+c+")"),n.imageFilenames=n.a=null):n.imageFilenames=n.a=d.imageFilenames:n.imageFilenames=n.a=null;e&&e(n)}Kb.call(this);for(var h in d)if(d.hasOwnProperty(h))if(Mb.hasOwnProperty(h)){var k=
Mb[h],p=d[h];if(k.valid&&-1===k.valid.indexOf(p)||k.Za&&(p<k.Za[0]||p>k.Za[1]))console.warn("CsvDataset warning: Invalid value for option "+h+": "+p),delete d[h]}else console.warn("CsvDataset warning: Unsupported option: "+h);var n=this;if(N(b))h=new XMLHttpRequest,h.onreadystatechange=function(){4==this.readyState&&200==this.status&&c(this.responseText)},h.open("GET",b,!0),h.overrideMimeType("text/csv; charset=utf8"),h.send();else{var m=new FileReader;m.onload=function(){return c(m.result)};m.readAsText(b)}});
function Lb(b,d){var e=["x","y","z","w"];return d<=e.length?e[b]:26>=d?String.fromCharCode(65+b):"c"+(b+1)};/*

 Copyright 2010, Google Inc.
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

     * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
     * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following disclaimer
 in the documentation and/or other materials provided with the
 distribution.
     * Neither the name of Google Inc. nor the names of its
 contributors may be used to endorse or promote products derived from
 this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
window.a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)};
